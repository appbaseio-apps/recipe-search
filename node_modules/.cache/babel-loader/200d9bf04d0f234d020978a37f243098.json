{"ast":null,"code":"import AppbaseAnalytics from '@appbaseio/analytics';\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Observable = /*#__PURE__*/function () {\n  function Observable() {\n    this.observers = [];\n  }\n\n  var _proto = Observable.prototype;\n\n  _proto.subscribe = function subscribe(fn, propertiesToSubscribe) {\n    this.observers.push({\n      callback: fn,\n      properties: propertiesToSubscribe\n    });\n  };\n\n  _proto.unsubscribe = function unsubscribe(fn) {\n    if (fn) {\n      this.observers = this.observers.filter(function (item) {\n        if (item.callback !== fn) {\n          return item;\n        }\n\n        return null;\n      });\n    } else {\n      this.observers = [];\n    }\n  };\n\n  _proto.next = function next(o, property, thisObj) {\n    var scope = thisObj;\n\n    if (!scope && window) {\n      scope = window;\n    }\n\n    this.observers.forEach(function (item) {\n      // filter by subscribed properties\n      if (item.properties === undefined) {\n        item.callback.call(scope, o);\n      } else if (item.properties instanceof Array && item.properties.length && item.properties.includes(property)) {\n        item.callback.call(scope, o);\n      } else if (typeof item.properties === 'string' && item.properties && item.properties === property) {\n        item.callback.call(scope, o);\n      }\n    });\n  };\n\n  return Observable;\n}();\n\nfunction getErrorMessage(msg) {\n  return \"SearchBase: \" + msg;\n}\n\nvar errorMessages = {\n  invalidIndex: getErrorMessage('Please provide a valid index.'),\n  invalidURL: getErrorMessage('Please provide a valid url.'),\n  invalidComponentId: getErrorMessage('Please provide component id.'),\n  invalidDataField: getErrorMessage('Please provide data field.'),\n  dataFieldAsArray: getErrorMessage('Only components with `search` type supports the multiple data fields. Please define `dataField` as a string.')\n};\nvar popularSuggestionFields = ['key', 'key.autosuggest'];\nvar queryTypes = {\n  Search: 'search',\n  Term: 'term',\n  Geo: 'geo',\n  Range: 'range'\n};\n\nvar withClickIds = function withClickIds(results) {\n  if (results === void 0) {\n    results = [];\n  }\n\n  return results.map(function (result, index) {\n    return _extends({}, result, {\n      _click_id: index + 1\n    });\n  });\n};\n\nvar highlightResults = function highlightResults(result) {\n  var data = _extends({}, result);\n\n  if (data.highlight) {\n    Object.keys(data.highlight).forEach(function (highlightItem) {\n      var _extends2;\n\n      var highlightValue = data.highlight[highlightItem][0];\n      data._source = _extends({}, data._source, (_extends2 = {}, _extends2[highlightItem] = highlightValue, _extends2));\n    });\n  }\n\n  return data;\n};\n\nvar parseHits = function parseHits(hits) {\n  var results = [];\n\n  if (hits) {\n    results = [].concat(hits).map(function (item) {\n      var data = highlightResults(item);\n      var result = Object.keys(data).filter(function (key) {\n        return key !== '_source';\n      }).reduce(function (obj, key) {\n        // eslint-disable-next-line\n        obj[key] = data[key];\n        return obj;\n      }, _extends({}, data._source));\n      return result;\n    });\n  }\n\n  return results;\n};\n\nvar getNormalizedField = function getNormalizedField(field) {\n  if (field) {\n    // if data field is string\n    if (!Array.isArray(field)) {\n      return [field];\n    }\n\n    if (field.length) {\n      var fields = [];\n      field.forEach(function (dataField) {\n        if (typeof dataField === 'string') {\n          fields.push(dataField);\n        } else if (dataField.field) {\n          // if data field is an array of objects\n          fields.push(dataField.field);\n        }\n      });\n      return fields;\n    }\n  }\n\n  return undefined;\n};\n\nfunction isNumber(n) {\n  return !Number.isNaN(parseFloat(n)) && Number.isFinite(n);\n}\n\nvar getNormalizedWeights = function getNormalizedWeights(field) {\n  if (field && Array.isArray(field) && field.length) {\n    var weights = [];\n    field.forEach(function (dataField) {\n      if (isNumber(dataField.weight)) {\n        // if data field is an array of objects\n        weights.push(dataField.weight);\n      } else {\n        // Add default weight as 1 to maintain order\n        weights.push(1);\n      }\n    });\n    return weights;\n  }\n\n  return undefined;\n};\n\nfunction flatReactProp(reactProp, componentID) {\n  var flattenReact = [];\n\n  var flatReact = function flatReact(react) {\n    if (react && Object.keys(react)) {\n      Object.keys(react).forEach(function (r) {\n        if (react[r]) {\n          if (typeof react[r] === 'string') {\n            flattenReact = [].concat(flattenReact, [react[r]]);\n          } else if (Array.isArray(react[r])) {\n            flattenReact = [].concat(flattenReact, react[r]);\n          } else if (typeof react[r] === 'object') {\n            flatReact(react[r]);\n          }\n        }\n      });\n    }\n  };\n\n  flatReact(reactProp); // Remove cyclic dependencies i.e dependencies on it's own\n\n  flattenReact = flattenReact.filter(function (react) {\n    return react !== componentID;\n  });\n  return flattenReact;\n} // flattens a nested array\n\n\nvar flatten = function flatten(arr) {\n  return arr.reduce(function (flat, toFlatten) {\n    return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\n  }, []);\n}; // helper function to extract suggestions\n\n\nvar extractSuggestion = function extractSuggestion(val) {\n  if (typeof val === 'object') {\n    if (Array.isArray(val)) {\n      return flatten(val);\n    }\n\n    return null;\n  }\n\n  return val;\n};\n\nfunction escapeRegExp(string) {\n  if (string === void 0) {\n    string = '';\n  }\n\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nvar getPredictiveSuggestions = function getPredictiveSuggestions(_ref) {\n  var suggestions = _ref.suggestions,\n      currentValue = _ref.currentValue,\n      wordsToShowAfterHighlight = _ref.wordsToShowAfterHighlight;\n  var suggestionMap = {};\n\n  if (currentValue) {\n    var currentValueTrimmed = currentValue.trim();\n    var parsedSuggestion = suggestions.reduce(function (agg, _ref2) {\n      var label = _ref2.label,\n          rest = _objectWithoutPropertiesLoose(_ref2, [\"label\"]); // to handle special strings with pattern '<mark>xyz</mark> <a href=\"test'\n\n\n      var parsedContent = new DOMParser().parseFromString(label, 'text/html').documentElement.textContent; // to match the partial start of word.\n      // example if searchTerm is `select` and string contains `selected`\n\n      var regexString = \"^(\" + escapeRegExp(currentValueTrimmed) + \")\\\\w+\";\n      var regex = new RegExp(regexString, 'i');\n      var regexExecution = regex.exec(parsedContent); // if execution value is null it means either there is no match or there are chances\n      // that exact word is present\n\n      if (!regexExecution) {\n        // regex to match exact word\n        regexString = \"^(\" + escapeRegExp(currentValueTrimmed) + \")\";\n        regex = new RegExp(regexString, 'i');\n        regexExecution = regex.exec(parsedContent);\n      }\n\n      if (regexExecution) {\n        var matchedString = parsedContent.slice(regexExecution.index, parsedContent.length);\n        var highlightedWord = matchedString.slice(currentValueTrimmed.length).split(' ').slice(0, wordsToShowAfterHighlight + 1).join(' ');\n        var suggestionPhrase = currentValueTrimmed + \"<mark class=\\\"highlight\\\">\" + highlightedWord + \"</mark>\";\n        var suggestionValue = \"\" + currentValueTrimmed + highlightedWord; // to show unique results only\n\n        if (!suggestionMap[suggestionPhrase]) {\n          suggestionMap[suggestionPhrase] = 1;\n          return [].concat(agg, [_extends({}, rest, {\n            label: suggestionPhrase,\n            value: suggestionValue,\n            isPredictiveSuggestion: true\n          })]);\n        }\n\n        return agg;\n      }\n\n      return agg;\n    }, []);\n    return parsedSuggestion;\n  }\n\n  return [];\n};\n/**\n *\n * @param {array} fields DataFields passed on Search Components\n * @param {array} suggestions Raw Suggestions received from ES\n * @param {string} currentValue Search Term\n * @param {boolean} showDistinctSuggestions When set to true will only return 1 suggestion per document\n * @param {boolean} enablePredictiveSuggestions When set to true will return the predictive suggestions list instead of the deafult list\n */\n\n\nvar getSuggestions = function getSuggestions(fields, suggestions, value, showDistinctSuggestions, enablePredictiveSuggestions) {\n  if (fields === void 0) {\n    fields = [];\n  }\n\n  if (value === void 0) {\n    value = '';\n  }\n\n  if (showDistinctSuggestions === void 0) {\n    showDistinctSuggestions = true;\n  }\n\n  if (enablePredictiveSuggestions === void 0) {\n    enablePredictiveSuggestions = false;\n  }\n\n  var suggestionsList = [];\n  var labelsList = [];\n  var skipWordMatch = false; //  Use to skip the word match logic, important for synonym\n\n  var currentValue = value || '';\n\n  var populateSuggestionsList = function populateSuggestionsList(val, parsedSource, source) {\n    // check if the suggestion includes the current value\n    // and not already included in other suggestions\n    var isWordMatch = skipWordMatch || currentValue.trim().split(' ').some(function (term) {\n      return String(val).toLowerCase().includes(term);\n    }); // promoted results should always include in suggestions even there is no match\n\n    if (isWordMatch && !labelsList.includes(val) || source._promoted) {\n      var defaultOption = {\n        label: val,\n        value: val,\n        source: source\n      };\n\n      var option = _extends({}, defaultOption);\n\n      labelsList = [].concat(labelsList, [val]);\n      suggestionsList = [].concat(suggestionsList, [option]);\n\n      if (showDistinctSuggestions) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var parseField = function parseField(parsedSource, field, source) {\n    if (field === void 0) {\n      field = '';\n    }\n\n    if (source === void 0) {\n      source = parsedSource;\n    }\n\n    if (typeof parsedSource === 'object') {\n      var fieldNodes = field.split('.');\n      var label = parsedSource[fieldNodes[0]];\n\n      if (label) {\n        if (fieldNodes.length > 1) {\n          // nested fields of the 'foo.bar.zoo' variety\n          var children = field.substring(fieldNodes[0].length + 1);\n\n          if (Array.isArray(label)) {\n            label.forEach(function (arrayItem) {\n              parseField(arrayItem, children, source);\n            });\n          } else {\n            parseField(label, children, source);\n          }\n        } else {\n          var val = extractSuggestion(label);\n\n          if (val) {\n            if (Array.isArray(val)) {\n              if (showDistinctSuggestions) {\n                return val.some(function (suggestion) {\n                  return populateSuggestionsList(suggestion, parsedSource, source);\n                });\n              }\n\n              val.forEach(function (suggestion) {\n                return populateSuggestionsList(suggestion, parsedSource, source);\n              });\n            }\n\n            return populateSuggestionsList(val, parsedSource, source);\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var traverseSuggestions = function traverseSuggestions() {\n    if (showDistinctSuggestions) {\n      suggestions.forEach(function (item) {\n        fields.some(function (field) {\n          return parseField(item, field);\n        });\n      });\n    } else {\n      suggestions.forEach(function (item) {\n        fields.forEach(function (field) {\n          parseField(item, field);\n        });\n      });\n    }\n  };\n\n  traverseSuggestions();\n\n  if (suggestionsList.length < suggestions.length && !skipWordMatch) {\n    /*\n    When we have synonym we set skipWordMatch to false as it may discard\n    the suggestion if word doesnt match term.\n    For eg: iphone, ios are synonyms and on searching iphone isWordMatch\n    in  populateSuggestionList may discard ios source which decreases no.\n    of items in suggestionsList\n    */\n    skipWordMatch = true;\n    traverseSuggestions();\n  }\n\n  if (enablePredictiveSuggestions) {\n    return getPredictiveSuggestions({\n      suggestions: suggestionsList,\n      currentValue: value,\n      wordsToShowAfterHighlight: true\n    });\n  }\n\n  return suggestionsList;\n};\n\nfunction parseCompAggToHits(aggFieldName, buckets) {\n  if (buckets === void 0) {\n    buckets = [];\n  }\n\n  return buckets.map(function (bucket) {\n    // eslint-disable-next-line camelcase\n    var doc_count = bucket.doc_count,\n        key = bucket.key,\n        data = bucket[aggFieldName];\n    return _extends({\n      _doc_count: doc_count,\n      // To handle the aggregation results for term and composite aggs\n      _key: key[aggFieldName] !== undefined ? key[aggFieldName] : key\n    }, data);\n  });\n}\n\nfunction isEqual(x, y) {\n  if (x === y) return true;\n  if (!(x instanceof Object) || !(y instanceof Object)) return false;\n  if (x.constructor !== y.constructor) return false;\n  /* eslint-disable */\n\n  for (var p in x) {\n    if (!x.hasOwnProperty(p)) continue;\n    if (!y.hasOwnProperty(p)) return false;\n    if (x[p] === y[p]) continue;\n    if (typeof x[p] !== 'object') return false;\n    if (!isEqual(x[p], y[p])) return false;\n  }\n\n  for (var _p in y) {\n    if (y.hasOwnProperty(_p) && !x.hasOwnProperty(_p)) return false;\n  }\n  /* eslint-enable */\n\n\n  return true;\n}\n\nvar searchBaseMappings = {\n  id: 'id',\n  type: 'type',\n  react: 'react',\n  queryFormat: 'queryFormat',\n  dataField: 'dataField',\n  categoryField: 'categoryField',\n  categoryValue: 'categoryValue',\n  nestedField: 'nestedField',\n  from: 'from',\n  size: 'size',\n  sortBy: 'sortBy',\n  value: 'value',\n  aggregationField: 'aggregationField',\n  aggregationSize: 'aggregationSize',\n  after: 'after',\n  includeNullValues: 'includeNullValues',\n  includeFields: 'includeFields',\n  excludeFields: 'excludeFields',\n  fuzziness: 'fuzziness',\n  searchOperators: 'searchOperators',\n  highlight: 'highlight',\n  highlightField: 'highlightField',\n  customHighlight: 'customHighlight',\n  interval: 'interval',\n  aggregations: 'aggregations',\n  missingLabel: 'missingLabel',\n  showMissing: 'showMissing',\n  enableSynonyms: 'enableSynonyms',\n  selectAllLabel: 'selectAllLabel',\n  pagination: 'pagination',\n  queryString: 'queryString',\n  enablePopularSuggestions: 'enablePopularSuggestions',\n  showDistinctSuggestions: 'showDistinctSuggestions',\n  error: 'error',\n  defaultQuery: 'defaultQuery',\n  customQuery: 'customQuery',\n  requestStatus: 'requestStatus',\n  results: 'results',\n  aggregationData: 'aggregationData',\n  micStatus: 'micStatus',\n  micInstance: 'micInstance',\n  micActive: 'micActive',\n  micInactive: 'micInactive',\n  micDenied: 'micDenied',\n  query: 'query',\n  requestPending: 'loading',\n  appbaseSettings: 'appbaseConfig',\n  suggestions: 'suggestions',\n  queryId: 'queryId',\n  recentSearches: 'recentSearches',\n  distinctField: 'distinctField',\n  distinctFieldConfig: 'distinctFieldConfig',\n  // ---------------- Methods -----------------------\n  onMicClick: 'handleMicClick',\n  triggerDefaultQuery: 'triggerDefaultQuery',\n  triggerCustomQuery: 'triggerCustomQuery',\n  recordClick: 'recordClick',\n  recordConversions: 'recordConversions',\n  subscribeToStateChanges: 'subscribeToStateChanges',\n  unsubscribeToStateChanges: 'unsubscribeToStateChanges',\n  // ---------------- Setter Methods ----------------\n  setDataField: 'setDataField',\n  setValue: 'setValue',\n  setSize: 'setSize',\n  setFrom: 'setFrom',\n  setFuzziness: 'setFuzziness',\n  setIncludeFields: 'setIncludeFields',\n  setExcludeFields: 'setExcludeFields',\n  setSortBy: 'setSortBy',\n  setReact: 'setReact',\n  setDefaultQuery: 'setDefaultQuery',\n  setCustomQuery: 'setCustomQuery',\n  setAfter: 'setAfter'\n};\n\nfunction btoa(input) {\n  if (input === void 0) {\n    input = '';\n  }\n\n  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  var str = input;\n  var output = ''; // eslint-disable-next-line\n\n  for (var block = 0, charCode, i = 0, map = chars; str.charAt(i | 0) || (map = '=', i % 1); // eslint-disable-line no-bitwise\n  output += map.charAt(63 & block >> 8 - i % 1 * 8) // eslint-disable-line no-bitwise\n  ) {\n    charCode = str.charCodeAt(i += 3 / 4);\n\n    if (charCode > 0xff) {\n      throw new Error('\"btoa\" failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode; // eslint-disable-line no-bitwise\n  }\n\n  return output;\n}\n/**\n * Base class is the abstract class for SearchBase and SearchComponent classes.\n */\n\n\nvar Base = /*#__PURE__*/function () {\n  // to enable the recording of analytics\n  // auth credentials if any\n  // custom headers object\n  // es index name\n  // es url\n\n  /* ---- callbacks to create the side effects while querying ----- */\n\n  /* ------ Private properties only for the internal use ----------- */\n  // analytics instance\n  // query search ID\n  function Base(_ref) {\n    var index = _ref.index,\n        url = _ref.url,\n        credentials = _ref.credentials,\n        headers = _ref.headers,\n        appbaseConfig = _ref.appbaseConfig,\n        transformRequest = _ref.transformRequest,\n        transformResponse = _ref.transformResponse;\n\n    if (!index) {\n      throw new Error(errorMessages.invalidIndex);\n    }\n\n    if (!url) {\n      throw new Error(errorMessages.invalidURL);\n    }\n\n    this.index = index;\n    this.url = url;\n    this.credentials = credentials || '';\n\n    if (appbaseConfig) {\n      this.appbaseConfig = appbaseConfig;\n    }\n\n    if (transformRequest) {\n      this.transformRequest = transformRequest;\n    }\n\n    if (transformResponse) {\n      this.transformResponse = transformResponse;\n    } // Initialize headers\n\n\n    this.headers = {\n      Accept: 'application/json',\n      'Content-Type': 'application/json'\n    };\n\n    if (this.credentials) {\n      this.headers = _extends({}, this.headers, {\n        Authorization: \"Basic \" + btoa(this.credentials)\n      });\n    }\n\n    if (headers) {\n      this.setHeaders(headers);\n    } // Create analytics index\n\n\n    this._analyticsInstance = AppbaseAnalytics.init({\n      index: index,\n      url: url,\n      credentials: credentials\n    });\n  } // To to set the custom headers\n\n\n  var _proto = Base.prototype;\n\n  _proto.setHeaders = function setHeaders(headers) {\n    this.headers = _extends({}, this.headers, headers);\n  } // To set the query ID\n  ;\n\n  _proto.setQueryID = function setQueryID(queryID) {\n    this._queryId = queryID;\n  };\n\n  return Base;\n}();\n\nvar Results = /*#__PURE__*/function () {\n  // An array of results obtained from the applied query.\n  // Raw response returned by ES query\n  // Results parser\n  function Results(data) {\n    var _this = this;\n\n    _defineProperty(this, \"setRaw\", function (rawResponse) {\n      // set response\n      _this.raw = rawResponse;\n\n      if (rawResponse.hits && rawResponse.hits.hits) {\n        _this.setData(rawResponse.hits.hits);\n      }\n    });\n\n    this.data = data || [];\n  } // Total number of results found\n\n\n  var _proto = Results.prototype; // Method to set data explicitly\n\n  _proto.setData = function setData(data) {\n    // parse hits\n    var filteredResults = parseHits(data); // filter results & remove duplicates if any\n\n    if (this.promotedData.length) {\n      var ids = this.promotedData.map(function (item) {\n        return item._id;\n      }).filter(Boolean);\n\n      if (ids) {\n        filteredResults = filteredResults.filter(function (item) {\n          return !ids.includes(item._id);\n        });\n      }\n\n      filteredResults = [].concat(this.promotedData.map(function (dataItem) {\n        return _extends({}, dataItem, {\n          _promoted: true\n        });\n      }), filteredResults);\n    } // set data\n\n\n    if (this.parseResults) {\n      this.data = this.parseResults(filteredResults, data);\n    } else {\n      this.data = filteredResults;\n    } // Add click ids in data\n\n\n    this.data = withClickIds(this.data);\n  };\n\n  _createClass(Results, [{\n    key: \"numberOfResults\",\n    get: function get() {\n      // calculate from raw response\n      if (this.raw && this.raw.hits) {\n        return typeof this.raw.hits.total === 'object' ? this.raw.hits.total.value : this.raw.hits.total;\n      }\n\n      return 0;\n    } // Total time taken by request (in ms)\n\n  }, {\n    key: \"time\",\n    get: function get() {\n      // calculate from raw response\n      if (this.raw) {\n        return this.raw.took;\n      }\n\n      return 0;\n    } // no of hidden results found\n\n  }, {\n    key: \"hidden\",\n    get: function get() {\n      if (this.raw && this.raw.hits) {\n        return this.raw.hits.hidden || 0;\n      }\n\n      return 0;\n    } // An array of promoted results obtained from the applied query.\n\n  }, {\n    key: \"promotedData\",\n    get: function get() {\n      if (this.raw && this.raw.promoted) {\n        return this.raw.promoted || [];\n      }\n\n      return [];\n    } // no of promoted results found\n\n  }, {\n    key: \"promoted\",\n    get: function get() {\n      return this.promotedData.length || 0;\n    } // An object of raw response as-is from elasticsearch query\n\n  }, {\n    key: \"rawData\",\n    get: function get() {\n      return this.raw || {};\n    } // object of custom data applied through queryRules\n    // only works when `enableAppbase=true`\n\n  }, {\n    key: \"customData\",\n    get: function get() {\n      if (this.raw && this.raw.customData) {\n        return this.raw.customData || {};\n      }\n\n      return {};\n    }\n  }]);\n\n  return Results;\n}();\n\nvar Aggregations = /*#__PURE__*/function () {\n  // An array of composite aggregations obtained from the applied aggs in options.\n  // useful when loading data of greater size\n  // Raw aggregations returned by ES query\n  function Aggregations(data) {\n    this.data = data || [];\n  } // An object of raw response as-is from elasticsearch query\n\n\n  var _proto = Aggregations.prototype;\n\n  _proto.setRaw = function setRaw(rawResponse) {\n    // set response\n    this.raw = rawResponse;\n    if (rawResponse.after_key) this.setAfterKey(rawResponse.after_key);\n  };\n\n  _proto.setAfterKey = function setAfterKey(key) {\n    this.afterKey = key;\n  } // Method to set data explicitly\n  ;\n\n  _proto.setData = function setData(aggField, data, append) {\n    if (append === void 0) {\n      append = false;\n    } // parse aggregation buckets\n\n\n    var parsedData = parseCompAggToHits(aggField, data); // Merge data\n\n    if (append) {\n      this.data = [].concat(this.data, parsedData);\n    } else {\n      this.data = parsedData;\n    }\n  };\n\n  _createClass(Aggregations, [{\n    key: \"rawData\",\n    get: function get() {\n      return this.raw || {};\n    }\n  }]);\n\n  return Aggregations;\n}();\n\nvar defaultOptions = {\n  triggerDefaultQuery: true,\n  triggerCustomQuery: false,\n  stateChanges: true\n};\nvar defaultOption = {\n  stateChanges: true\n};\nvar MIC_STATUS = {\n  inactive: 'INACTIVE',\n  active: 'ACTIVE',\n  denied: 'DENIED'\n};\nvar REQUEST_STATUS = {\n  inactive: 'INACTIVE',\n  pending: 'PENDING',\n  error: 'ERROR'\n};\nvar suggestionQueryID = 'DataSearch__suggestions';\n/**\n * SearchComponent class is responsible for the following things:\n * - It provides the methods to trigger the query\n * - It maintains the request state for e.g loading, error etc.\n * - It handles the `custom` and `default` queries\n * - Basically the SearchComponent class provides all the utilities to build any ReactiveSearch component\n */\n\nvar SearchComponent = /*#__PURE__*/function (_Base) {\n  _inheritsLoose(SearchComponent, _Base); // RS API properties\n  // other properties\n  // To enable the popular suggestions\n  // size of the popular suggestions\n  // To show the distinct suggestions\n  // To show the predictive suggestions\n  // preserve the data for infinite loading\n  // to clear the dependent facets values on query change\n  // query error\n  // state changes subject\n  // request status\n  // results\n  // aggregations\n  // recent searches\n\n  /* ------ Private properties only for the internal use ----------- */\n  // Counterpart of the query\n  // TODO: Check on the below properties\n  // mic status\n  // mic instance\n  // query search ID\n\n  /* ---- callbacks to create the side effects while querying ----- */\n\n  /* ------------- change events -------------------------------- */\n  // called when value changes\n  // called when results change\n  // called when composite aggregationData change\n  // called when there is an error while fetching results\n  // called when request status changes\n  // called when query changes\n  // called when mic status changes\n\n\n  function SearchComponent(_ref) {\n    var _this;\n\n    var index = _ref.index,\n        url = _ref.url,\n        credentials = _ref.credentials,\n        appbaseConfig = _ref.appbaseConfig,\n        headers = _ref.headers,\n        transformRequest = _ref.transformRequest,\n        transformResponse = _ref.transformResponse,\n        beforeValueChange = _ref.beforeValueChange,\n        onValueChange = _ref.onValueChange,\n        onResults = _ref.onResults,\n        onAggregationData = _ref.onAggregationData,\n        onError = _ref.onError,\n        onRequestStatusChange = _ref.onRequestStatusChange,\n        onQueryChange = _ref.onQueryChange,\n        onMicStatusChange = _ref.onMicStatusChange,\n        enablePopularSuggestions = _ref.enablePopularSuggestions,\n        maxPopularSuggestions = _ref.maxPopularSuggestions,\n        _results = _ref.results,\n        showDistinctSuggestions = _ref.showDistinctSuggestions,\n        enablePredictiveSuggestions = _ref.enablePredictiveSuggestions,\n        preserveResults = _ref.preserveResults,\n        clearOnQueryChange = _ref.clearOnQueryChange,\n        rsAPIConfig = _objectWithoutPropertiesLoose(_ref, [\"index\", \"url\", \"credentials\", \"appbaseConfig\", \"headers\", \"transformRequest\", \"transformResponse\", \"beforeValueChange\", \"onValueChange\", \"onResults\", \"onAggregationData\", \"onError\", \"onRequestStatusChange\", \"onQueryChange\", \"onMicStatusChange\", \"enablePopularSuggestions\", \"maxPopularSuggestions\", \"results\", \"showDistinctSuggestions\", \"enablePredictiveSuggestions\", \"preserveResults\", \"clearOnQueryChange\"]);\n\n    _this = _Base.call(this, {\n      index: index,\n      url: url,\n      credentials: credentials,\n      headers: headers,\n      appbaseConfig: appbaseConfig,\n      transformRequest: transformRequest,\n      transformResponse: transformResponse\n    }) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"onMicClick\", function (micOptions, options) {\n      if (micOptions === void 0) {\n        micOptions = {};\n      }\n\n      if (options === void 0) {\n        options = {\n          triggerDefaultQuery: false,\n          triggerCustomQuery: false,\n          stateChanges: true\n        };\n      }\n\n      var prevStatus = _this._micStatus;\n\n      if (typeof window !== 'undefined') {\n        window.SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition || null;\n      }\n\n      if (window && window.SpeechRecognition && prevStatus !== MIC_STATUS.denied) {\n        if (prevStatus === MIC_STATUS.active) {\n          _this._setMicStatus(MIC_STATUS.inactive, options);\n        }\n\n        var _window = window,\n            SpeechRecognition = _window.SpeechRecognition;\n\n        if (_this._micInstance) {\n          _this._stopMic();\n\n          return;\n        }\n\n        _this._micInstance = new SpeechRecognition();\n        _this._micInstance.continuous = true;\n        _this._micInstance.interimResults = true;\n        Object.assign(_this._micInstance, micOptions);\n\n        _this._micInstance.start();\n\n        _this._micInstance.onstart = function () {\n          _this._setMicStatus(MIC_STATUS.active, options);\n        };\n\n        _this._micInstance.onresult = function (_ref2) {\n          var results = _ref2.results;\n\n          if (results && results[0] && results[0].isFinal) {\n            _this._stopMic();\n          }\n\n          _this._handleVoiceResults({\n            results: results\n          }, options);\n        };\n\n        _this._micInstance.onerror = function (e) {\n          if (e.error === 'no-speech' || e.error === 'audio-capture') {\n            _this._setMicStatus(MIC_STATUS.inactive, options);\n          } else if (e.error === 'not-allowed') {\n            _this._setMicStatus(MIC_STATUS.denied, options);\n          }\n\n          console.error(e);\n        };\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setDataField\", function (dataField, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.dataField;\n      _this.dataField = dataField;\n\n      _this._applyOptions(options, 'dataField', prev, dataField);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setParent\", function (parent) {\n      _this._parent = parent;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setValue\", function (value, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var performUpdate = function performUpdate() {\n        var prev = _this.value;\n        _this.value = value;\n\n        _this._applyOptions(options, 'value', prev, _this.value);\n      };\n\n      if (_this.beforeValueChange) {\n        _this.beforeValueChange(value).then(performUpdate)[\"catch\"](function (e) {\n          console.warn('beforeValueChange rejected the promise with ', e);\n        });\n      } else {\n        performUpdate();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSize\", function (size, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.size;\n      _this.size = size;\n\n      _this._applyOptions(options, 'size', prev, _this.size);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setFrom\", function (from, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.from;\n      _this.from = from;\n\n      _this._applyOptions(options, 'from', prev, _this.from);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setFuzziness\", function (fuzziness, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.fuzziness;\n      _this.fuzziness = fuzziness;\n\n      _this._applyOptions(options, 'fuzziness', prev, _this.fuzziness);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setIncludeFields\", function (includeFields, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.includeFields;\n      _this.includeFields = includeFields;\n\n      _this._applyOptions(options, 'includeFields', prev, includeFields);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setExcludeFields\", function (excludeFields, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.excludeFields;\n      _this.excludeFields = excludeFields;\n\n      _this._applyOptions(options, 'excludeFields', prev, excludeFields);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSortBy\", function (sortBy, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.sortBy;\n      _this.sortBy = sortBy;\n\n      _this._applyOptions(options, 'sortBy', prev, sortBy);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setReact\", function (react, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.react;\n      _this.react = react;\n\n      _this._applyOptions(options, 'react', prev, react);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setDefaultQuery\", function (defaultQuery, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.defaultQuery;\n      _this.defaultQuery = defaultQuery;\n\n      _this._applyOptions(options, 'defaultQuery', prev, defaultQuery);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setCustomQuery\", function (customQuery, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.customQuery;\n      _this.customQuery = customQuery;\n\n      _this._applyOptions(options, 'customQuery', prev, customQuery);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setAfter\", function (after, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.after;\n      _this.after = after;\n\n      _this.aggregationData.setAfterKey(after);\n\n      _this._applyOptions(options, 'after', prev, after);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"triggerDefaultQuery\", function (options) {\n      if (options === void 0) {\n        options = defaultOption;\n      } // To prevent duplicate queries\n\n\n      if (isEqual(_this._query, _this.componentQuery)) {\n        return Promise.resolve(true);\n      }\n\n      var handleError = function handleError(err) {\n        _this._setError(err, {\n          stateChanges: options.stateChanges\n        });\n\n        console.error(err);\n        return Promise.reject(err);\n      };\n\n      try {\n        _this._updateQuery();\n\n        _this._setRequestStatus(REQUEST_STATUS.pending);\n\n        return _this._fetchRequest({\n          query: Array.isArray(_this.query) ? _this.query : [_this.query],\n          settings: _this.appbaseSettings\n        }).then(function (results) {\n          var prev = _this.results;\n          var rawResults = results && results[_this.id];\n\n          var afterResponse = function afterResponse() {\n            if (rawResults.aggregations) {\n              _this._handleAggregationResponse(rawResults.aggregations, _extends({\n                defaultOptions: defaultOptions\n              }, options));\n            }\n\n            _this._setRequestStatus(REQUEST_STATUS.inactive);\n\n            _this._applyOptions({\n              stateChanges: options.stateChanges\n            }, 'results', prev, _this.results);\n          };\n\n          if ((!_this.type || _this.type === queryTypes.Search) && _this.enablePopularSuggestions) {\n            _this._fetchRequest(_this.getSuggestionsQuery(), true).then(function (rawPopularSuggestions) {\n              var popularSuggestionsData = rawPopularSuggestions[suggestionQueryID]; // Merge popular suggestions as the top suggestions\n\n              if (popularSuggestionsData && popularSuggestionsData.hits && popularSuggestionsData.hits.hits && rawResults.hits && rawResults.hits.hits) {\n                rawResults.hits.hits = [].concat((popularSuggestionsData.hits.hits || []).map(function (hit) {\n                  return _extends({}, hit, {\n                    // Set the popular suggestion tag for suggestion hits\n                    _popular_suggestion: true\n                  });\n                }), rawResults.hits.hits);\n              }\n\n              _this._appendResults(rawResults);\n\n              afterResponse();\n            })[\"catch\"](handleError);\n          } else {\n            _this._appendResults(rawResults);\n\n            afterResponse();\n          }\n\n          return Promise.resolve(rawResults);\n        })[\"catch\"](handleError);\n      } catch (err) {\n        return handleError(err);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"triggerCustomQuery\", function (options) {\n      if (options === void 0) {\n        options = defaultOption;\n      } // Generate query again after resetting changes\n\n\n      var _this$_generateQuery = _this._generateQuery(),\n          requestBody = _this$_generateQuery.requestBody,\n          orderOfQueries = _this$_generateQuery.orderOfQueries;\n\n      if (requestBody.length) {\n        if (isEqual(_this._query, requestBody)) {\n          return Promise.resolve(true);\n        }\n\n        var handleError = function handleError(err) {\n          _this._setError(err, {\n            stateChanges: options.stateChanges\n          });\n\n          console.error(err);\n          return Promise.reject(err);\n        };\n\n        try {\n          // set the request loading to true for all the requests\n          orderOfQueries.forEach(function (id) {\n            var componentInstance = _this._parent.getComponent(id);\n\n            if (componentInstance) {\n              // Reset `from` and `after` values\n              componentInstance.setFrom(0, {\n                stateChanges: true,\n                triggerDefaultQuery: false,\n                triggerCustomQuery: false\n              });\n              componentInstance.setAfter(undefined, {\n                stateChanges: true,\n                triggerDefaultQuery: false,\n                triggerCustomQuery: false\n              }); // Reset value for dependent components after fist query is made\n              // We wait for first query to not clear filters applied by URL params\n\n              if (_this.clearOnQueryChange && _this._query) {\n                componentInstance.setValue(undefined, {\n                  stateChanges: true,\n                  triggerDefaultQuery: false,\n                  triggerCustomQuery: false\n                });\n              }\n\n              componentInstance._setRequestStatus(REQUEST_STATUS.pending); // Update the query\n\n\n              componentInstance._updateQuery();\n            }\n          }); // Re-generate query after changes\n\n          var _this$_generateQuery2 = _this._generateQuery(),\n              finalRequest = _this$_generateQuery2.requestBody;\n\n          return _this._fetchRequest({\n            query: finalRequest,\n            settings: _this.appbaseSettings\n          }).then(function (results) {\n            // Update the state for components\n            orderOfQueries.forEach(function (id) {\n              var componentInstance = _this._parent.getComponent(id);\n\n              if (componentInstance) {\n                componentInstance._setRequestStatus(REQUEST_STATUS.inactive); // Update the results\n\n\n                var _prev = componentInstance.results; // Collect results from the response for a particular component\n\n                var rawResults = results && results[id]; // Set results\n\n                if (rawResults.hits) {\n                  componentInstance.results.setRaw(rawResults);\n\n                  componentInstance._applyOptions({\n                    stateChanges: options.stateChanges\n                  }, 'results', _prev, componentInstance.results);\n                }\n\n                if (rawResults.aggregations) {\n                  componentInstance._handleAggregationResponse(rawResults.aggregations, _extends({\n                    defaultOptions: defaultOptions\n                  }, options), false);\n                }\n              }\n            });\n            return Promise.resolve(results);\n          })[\"catch\"](handleError);\n        } catch (err) {\n          return handleError(err);\n        }\n      } else {\n        return Promise.resolve({});\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"recordClick\", function (objects, isSuggestionClick) {\n      if (isSuggestionClick === void 0) {\n        isSuggestionClick = false;\n      }\n\n      if (_this._analyticsInstance && _this.queryId) {\n        _this._analyticsInstance.click({\n          queryID: _this.queryId,\n          objects: objects,\n          isSuggestionClick: isSuggestionClick\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"recordConversions\", function (objects) {\n      if (_this._analyticsInstance && _this.queryId) {\n        _this._analyticsInstance.conversion({\n          queryID: _this.queryId,\n          objects: objects\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"subscribeToStateChanges\", function (fn, propertiesToSubscribe) {\n      _this.stateChanges.subscribe(fn, propertiesToSubscribe);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"unsubscribeToStateChanges\", function (fn) {\n      _this.stateChanges.unsubscribe(fn);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clearResults\", function (options) {\n      if (options === void 0) {\n        options = defaultOption;\n      }\n\n      var prev = _this.results;\n\n      _this.results.setRaw({\n        hits: {\n          hits: []\n        }\n      });\n\n      _this._applyOptions({\n        stateChanges: options.stateChanges\n      }, 'results', prev, _this.results);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getRecentSearches\", function (queryOptions, options) {\n      if (queryOptions === void 0) {\n        queryOptions = {\n          size: 5,\n          minChars: 3\n        };\n      }\n\n      if (options === void 0) {\n        options = defaultOption;\n      }\n\n      var requestOptions = {\n        headers: _extends({}, _this.headers)\n      };\n      var queryString = '';\n\n      var addParam = function addParam(key, value) {\n        if (queryString) {\n          queryString += \"&\" + key + \"=\" + value;\n        } else {\n          queryString += key + \"=\" + value;\n        }\n      };\n\n      if (_this.appbaseSettings && _this.appbaseSettings.userId) {\n        addParam('user_id', _this.appbaseSettings.userId);\n      }\n\n      if (queryOptions) {\n        if (queryOptions.size) {\n          addParam('size', String(queryOptions.size));\n        }\n\n        if (queryOptions.from) {\n          addParam('from', queryOptions.from);\n        }\n\n        if (queryOptions.to) {\n          addParam('to', queryOptions.to);\n        }\n\n        if (queryOptions.minChars) {\n          addParam('min_chars', String(queryOptions.minChars));\n        }\n\n        if (queryOptions.customEvents) {\n          Object.keys(queryOptions.customEvents).forEach(function (key) {\n            // $FlowFixMe\n            addParam(key, queryOptions.customEvents[key]);\n          });\n        }\n      }\n\n      return new Promise(function (resolve, reject) {\n        fetch(_this.url + \"/_analytics/\" + _this._getSearchIndex() + \"/recent-searches?\" + queryString, requestOptions).then(function (res) {\n          if (res.status >= 500) {\n            return reject(res);\n          }\n\n          if (res.status >= 400) {\n            return reject(res);\n          }\n\n          return res.json().then(function (recentSearches) {\n            var prev = _this.recentSearches;\n            _this.recentSearches = recentSearches.map(function (searchObject) {\n              return {\n                label: searchObject.key,\n                value: searchObject.key\n              };\n            });\n\n            _this._applyOptions({\n              stateChanges: options.stateChanges\n            }, 'recentSearches', prev, _this.recentSearches);\n\n            resolve(_this.recentSearches); // Populate the recent searches\n          })[\"catch\"](function (e) {\n            console.warn('SearchBase: error while fetching the recent searches ', e);\n            return reject(e);\n          });\n        })[\"catch\"](function (e) {\n          console.warn('SearchBase: error while fetching the recent searches ', e);\n          return reject(e);\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleVoiceResults\", function (_ref3, options) {\n      var results = _ref3.results;\n\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      if (results && results[0] && results[0].isFinal && results[0][0] && results[0][0].transcript && results[0][0].transcript.trim()) {\n        _this.setValue(results[0][0].transcript.trim(), _extends({}, options, {\n          triggerCustomQuery: true,\n          triggerDefaultQuery: true\n        }));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_stopMic\", function () {\n      if (_this._micInstance) {\n        _this._micInstance.stop();\n\n        _this._micInstance = null;\n\n        _this._setMicStatus(MIC_STATUS.inactive);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_setMicStatus\", function (status, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prevStatus = _this._micStatus;\n      _this._micStatus = status;\n\n      _this._applyOptions(options, 'micStatus', prevStatus, _this._micStatus);\n    });\n\n    var _id = rsAPIConfig.id,\n        type = rsAPIConfig.type,\n        _react = rsAPIConfig.react,\n        queryFormat = rsAPIConfig.queryFormat,\n        _dataField = rsAPIConfig.dataField,\n        categoryField = rsAPIConfig.categoryField,\n        categoryValue = rsAPIConfig.categoryValue,\n        nestedField = rsAPIConfig.nestedField,\n        _from = rsAPIConfig.from,\n        _size = rsAPIConfig.size,\n        _sortBy = rsAPIConfig.sortBy,\n        _value = rsAPIConfig.value,\n        aggregationField = rsAPIConfig.aggregationField,\n        aggregationSize = rsAPIConfig.aggregationSize,\n        _after = rsAPIConfig.after,\n        includeNullValues = rsAPIConfig.includeNullValues,\n        _includeFields = rsAPIConfig.includeFields,\n        _excludeFields = rsAPIConfig.excludeFields,\n        _fuzziness = rsAPIConfig.fuzziness,\n        searchOperators = rsAPIConfig.searchOperators,\n        highlight = rsAPIConfig.highlight,\n        highlightField = rsAPIConfig.highlightField,\n        customHighlight = rsAPIConfig.customHighlight,\n        interval = rsAPIConfig.interval,\n        aggregations = rsAPIConfig.aggregations,\n        missingLabel = rsAPIConfig.missingLabel,\n        showMissing = rsAPIConfig.showMissing,\n        _defaultQuery = rsAPIConfig.defaultQuery,\n        _customQuery = rsAPIConfig.customQuery,\n        execute = rsAPIConfig.execute,\n        enableSynonyms = rsAPIConfig.enableSynonyms,\n        selectAllLabel = rsAPIConfig.selectAllLabel,\n        pagination = rsAPIConfig.pagination,\n        _queryString = rsAPIConfig.queryString,\n        distinctField = rsAPIConfig.distinctField,\n        distinctFieldConfig = rsAPIConfig.distinctFieldConfig;\n\n    if (!_id) {\n      throw new Error(errorMessages.invalidComponentId);\n    } // dataField is required for components other then search\n\n\n    if (type && type !== queryTypes.Search) {\n      if (!_dataField) {\n        throw new Error(errorMessages.invalidDataField);\n      } else if (Array.isArray(_dataField)) {\n        throw new Error(errorMessages.dataFieldAsArray);\n      }\n    }\n\n    _this.id = _id;\n    _this.type = type;\n    _this.react = _react;\n    _this.queryFormat = queryFormat;\n    _this.dataField = _dataField;\n    _this.categoryField = categoryField;\n    _this.categoryValue = categoryValue;\n    _this.nestedField = nestedField;\n    _this.from = _from;\n    _this.size = _size;\n    _this.sortBy = _sortBy;\n    _this.aggregationField = aggregationField;\n    _this.aggregationSize = aggregationSize;\n    _this.after = _after;\n    _this.includeNullValues = includeNullValues;\n    _this.includeFields = _includeFields;\n    _this.excludeFields = _excludeFields;\n    _this.fuzziness = _fuzziness;\n    _this.searchOperators = searchOperators;\n    _this.highlight = highlight;\n    _this.highlightField = highlightField;\n    _this.customHighlight = customHighlight;\n    _this.interval = interval;\n    _this.aggregations = aggregations;\n    _this.missingLabel = missingLabel;\n    _this.showMissing = showMissing;\n    _this.execute = execute;\n    _this.enableSynonyms = enableSynonyms;\n    _this.selectAllLabel = selectAllLabel;\n    _this.pagination = pagination;\n    _this.queryString = _queryString;\n    _this.defaultQuery = _defaultQuery;\n    _this.customQuery = _customQuery;\n    _this.beforeValueChange = beforeValueChange;\n    _this.onValueChange = onValueChange;\n    _this.onResults = onResults;\n    _this.onAggregationData = onAggregationData;\n    _this.onError = onError;\n    _this.onRequestStatusChange = onRequestStatusChange;\n    _this.onQueryChange = onQueryChange;\n    _this.onMicStatusChange = onMicStatusChange;\n    _this.distinctField = distinctField;\n    _this.distinctFieldConfig = distinctFieldConfig; // other properties\n\n    _this.enablePopularSuggestions = enablePopularSuggestions;\n    _this.maxPopularSuggestions = maxPopularSuggestions;\n    _this.showDistinctSuggestions = showDistinctSuggestions;\n    _this.enablePredictiveSuggestions = enablePredictiveSuggestions;\n    _this.preserveResults = preserveResults;\n    _this.clearOnQueryChange = clearOnQueryChange; // Initialize the state changes observable\n\n    _this.stateChanges = new Observable();\n    _this.results = new Results(_results);\n    _this.aggregationData = new Aggregations();\n\n    if (_value) {\n      _this.setValue(_value, {\n        stateChanges: true\n      });\n    } else {\n      _this.value = _value;\n    }\n\n    return _this;\n  } // getters\n\n\n  var _proto = SearchComponent.prototype;\n\n  _proto.getSuggestionsQuery = function getSuggestionsQuery() {\n    return {\n      query: [{\n        id: suggestionQueryID,\n        dataField: popularSuggestionFields,\n        size: this.maxPopularSuggestions || 5,\n        value: this.value,\n        defaultQuery: {\n          query: {\n            bool: {\n              minimum_should_match: 1,\n              should: [{\n                function_score: {\n                  field_value_factor: {\n                    field: 'count',\n                    modifier: 'sqrt',\n                    missing: 1\n                  }\n                }\n              }, {\n                multi_match: {\n                  fields: ['key^9', 'key.autosuggest^1', 'key.keyword^10'],\n                  fuzziness: 0,\n                  operator: 'or',\n                  query: this.value,\n                  type: 'best_fields'\n                }\n              }, {\n                multi_match: {\n                  fields: ['key^9', 'key.autosuggest^1', 'key.keyword^10'],\n                  operator: 'or',\n                  query: this.value,\n                  type: 'phrase'\n                }\n              }, {\n                multi_match: {\n                  fields: ['key^9'],\n                  operator: 'or',\n                  query: this.value,\n                  type: 'phrase_prefix'\n                }\n              }]\n            }\n          }\n        }\n      }]\n    };\n  } // use this methods to record a search click event\n  ;\n  /* -------- Private methods only for the internal use -------- */\n\n\n  _proto._appendResults = function _appendResults(rawResults) {\n    if (this.preserveResults && rawResults && Array.isArray(rawResults.hits && rawResults.hits.hits) && Array.isArray(this.results.rawData && this.results.rawData.hits && this.results.rawData.hits.hits)) {\n      this.results.setRaw(_extends({}, rawResults, {\n        hits: _extends({}, rawResults.hits, {\n          hits: [].concat(this.results.rawData.hits.hits, rawResults.hits.hits)\n        })\n      }));\n    } else {\n      this.results.setRaw(rawResults);\n    }\n  } // Method to apply the changed based on set options\n  ;\n\n  _proto._applyOptions = function _applyOptions(options, key, prevValue, nextValue) {\n    // // Trigger mic events\n    if (key === 'micStatus' && this.onMicStatusChange) {\n      this.onMicStatusChange(nextValue, prevValue);\n    } // Trigger events\n\n\n    if (key === 'query' && this.onQueryChange) {\n      this.onQueryChange(nextValue, prevValue);\n    }\n\n    if (key === 'value' && this.onValueChange) {\n      this.onValueChange(nextValue, prevValue);\n    }\n\n    if (key === 'error' && this.onError) {\n      this.onError(nextValue);\n    }\n\n    if (key === 'results' && this.onResults) {\n      this.onResults(nextValue, prevValue);\n    }\n\n    if (key === 'aggregationData' && this.onAggregationData) {\n      this.onAggregationData(nextValue, prevValue);\n    }\n\n    if (key === 'requestStatus' && this.onRequestStatusChange) {\n      this.onRequestStatusChange(nextValue, prevValue);\n    }\n\n    if (options.triggerDefaultQuery) {\n      this.triggerDefaultQuery();\n    }\n\n    if (options.triggerCustomQuery) {\n      this.triggerCustomQuery();\n    }\n\n    if (options.stateChanges !== false) {\n      var _this$stateChanges$ne;\n\n      this.stateChanges.next((_this$stateChanges$ne = {}, _this$stateChanges$ne[key] = {\n        prev: prevValue,\n        next: nextValue\n      }, _this$stateChanges$ne), key, this);\n    }\n  };\n\n  _proto._getSearchIndex = function _getSearchIndex(isPopularSuggestionsAPI) {\n    if (isPopularSuggestionsAPI === void 0) {\n      isPopularSuggestionsAPI = false;\n    }\n\n    var index = this.index;\n\n    if (isPopularSuggestionsAPI) {\n      index = '.suggestions';\n    } else if (this._parent && this._parent.index) {\n      index = this._parent.index;\n    }\n\n    return index;\n  };\n\n  _proto._fetchRequest = function _fetchRequest(requestBody, isPopularSuggestionsAPI) {\n    var _this2 = this;\n\n    if (isPopularSuggestionsAPI === void 0) {\n      isPopularSuggestionsAPI = false;\n    } // remove undefined properties from request body\n\n\n    var requestOptions = {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: _extends({}, this.headers)\n    };\n    return new Promise(function (resolve, reject) {\n      _this2._handleTransformRequest(requestOptions).then(function (finalRequestOptions) {\n        // set timestamp in request\n        var timestamp = Date.now();\n        var suffix = '_reactivesearch.v3';\n\n        var index = _this2._getSearchIndex(isPopularSuggestionsAPI);\n\n        return fetch(_this2.url + \"/\" + index + \"/\" + suffix, finalRequestOptions).then(function (res) {\n          var responseHeaders = res.headers; // check if search component is present\n\n          if (res.headers) {\n            var queryID = res.headers.get('X-Search-Id');\n\n            if (queryID) {\n              // if parent exists then set the queryID to parent\n              if (_this2._parent) {\n                _this2._parent.setQueryID(queryID);\n              } else {\n                _this2.setQueryID(queryID);\n              }\n            }\n          }\n\n          if (res.status >= 500) {\n            return reject(res);\n          }\n\n          if (res.status >= 400) {\n            return reject(res);\n          }\n\n          return res.json().then(function (data) {\n            _this2._handleTransformResponse(data).then(function (transformedData) {\n              if (transformedData && Object.prototype.hasOwnProperty.call(transformedData, 'error')) {\n                reject(transformedData);\n              }\n\n              var response = _extends({}, transformedData, {\n                _timestamp: timestamp,\n                _headers: responseHeaders\n              });\n\n              return resolve(response);\n            })[\"catch\"](function (e) {\n              console.warn('SearchBase: transformResponse rejected the promise with ', e);\n              return reject(e);\n            });\n          });\n        })[\"catch\"](function (e) {\n          return reject(e);\n        });\n      })[\"catch\"](function (e) {\n        console.warn('SearchBase: transformRequest rejected the promise with ', e);\n        return reject(e);\n      });\n    });\n  } // Method to generate the final query based on the component's value changes\n  ;\n\n  _proto._generateQuery = function _generateQuery() {\n    var _this3 = this;\n    /**\n     * This method performs the following tasks to generate the query\n     * 1. Get all the watcher components for a particular component ID\n     * 2. Make the request payload\n     * 3. Execute the final query\n     * 4. Update results and trigger events => Call `setResults` or `setAggregations` based on the results\n     */\n\n\n    if (this._parent) {\n      var components = this._parent.getComponents();\n\n      var watcherComponents = []; // Find all the  watcher components\n\n      Object.keys(components).forEach(function (id) {\n        var componentInstance = components[id];\n\n        if (componentInstance && componentInstance.react) {\n          var flattenReact = flatReactProp(componentInstance.react, id);\n\n          if (flattenReact.indexOf(_this3.id) > -1) {\n            watcherComponents.push(id);\n          }\n        }\n      });\n      var requestQuery = {}; // Generate the request body for watchers\n\n      watcherComponents.forEach(function (watcherId) {\n        var component = _this3._parent.getComponent(watcherId);\n\n        if (component) {\n          requestQuery[watcherId] = component.componentQuery; // collect queries for all components defined in the `react` property\n          // that have some value defined\n\n          var flattenReact = flatReactProp(component.react, component.id);\n          flattenReact.forEach(function (id) {\n            // only add if not present\n            if (!requestQuery[id]) {\n              var dependentComponent = _this3._parent.getComponent(id);\n\n              if (dependentComponent && dependentComponent.value) {\n                // Set the execute to `false` for dependent components\n                var query = dependentComponent.componentQuery;\n                query.execute = false; // Add the query to request payload\n\n                requestQuery[id] = query;\n              }\n            }\n          });\n        }\n      });\n      return {\n        requestBody: Object.values(requestQuery),\n        orderOfQueries: watcherComponents\n      };\n    }\n\n    return {\n      requestBody: [],\n      orderOfQueries: []\n    };\n  };\n\n  _proto._handleTransformResponse = function _handleTransformResponse(res) {\n    if (this.transformResponse && typeof this.transformResponse === 'function') {\n      return this.transformResponse(res);\n    }\n\n    return new Promise(function (resolve) {\n      return resolve(res);\n    });\n  };\n\n  _proto._handleTransformRequest = function _handleTransformRequest(requestOptions) {\n    if (this.transformRequest && typeof this.transformRequest === 'function') {\n      return this.transformRequest(requestOptions);\n    }\n\n    return new Promise(function (resolve) {\n      return resolve(requestOptions);\n    });\n  };\n\n  _proto._handleAggregationResponse = function _handleAggregationResponse(aggsResponse, options, append) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    if (append === void 0) {\n      append = true;\n    }\n\n    var aggregationField = this.aggregationField;\n\n    if (!aggregationField && typeof this.dataField === 'string') {\n      aggregationField = this.dataField;\n    }\n\n    var prev = this.aggregationData;\n    this.aggregationData.setRaw(aggsResponse[aggregationField]);\n    this.aggregationData.setData(aggregationField, aggsResponse[aggregationField].buckets, this.preserveResults && append);\n\n    this._applyOptions({\n      stateChanges: options.stateChanges\n    }, 'aggregationData', prev, this.aggregationData);\n  };\n\n  _proto._setError = function _setError(error, options) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    this._setRequestStatus(REQUEST_STATUS.error);\n\n    var prev = this.error;\n    this.error = error;\n\n    this._applyOptions(options, 'error', prev, this.error);\n  };\n\n  _proto._setRequestStatus = function _setRequestStatus(requestStatus) {\n    var prev = this.requestStatus;\n    this.requestStatus = requestStatus;\n\n    this._applyOptions({\n      stateChanges: true\n    }, 'requestStatus', prev, this.requestStatus);\n  } // Method to set the default query value\n  ;\n\n  _proto._updateQuery = function _updateQuery(query) {\n    var _this4 = this;\n\n    var prevQuery;\n    prevQuery = _extends({}, this._query);\n    var finalQuery = [this.componentQuery];\n    var flattenReact = flatReactProp(this.react, this.id);\n    flattenReact.forEach(function (id) {\n      // only add if not present\n      var watcherComponent = _this4._parent.getComponent(id);\n\n      if (watcherComponent && watcherComponent.value) {\n        // Set the execute to `false` for watcher components\n        var watcherQuery = watcherComponent.componentQuery;\n        watcherQuery.execute = false; // Add the query to request payload\n\n        finalQuery.push(watcherQuery);\n      }\n    });\n    this._query = query || finalQuery;\n\n    this._applyOptions({\n      stateChanges: false\n    }, 'query', prevQuery, this._query);\n  } // mic\n  ;\n\n  _createClass(SearchComponent, [{\n    key: \"micStatus\",\n    get: function get() {\n      return this._micStatus;\n    }\n  }, {\n    key: \"micInstance\",\n    get: function get() {\n      return this._micInstance;\n    }\n  }, {\n    key: \"micActive\",\n    get: function get() {\n      return this._micStatus === MIC_STATUS.active;\n    }\n  }, {\n    key: \"micInactive\",\n    get: function get() {\n      return this._micStatus === MIC_STATUS.inactive;\n    }\n  }, {\n    key: \"micDenied\",\n    get: function get() {\n      return this._micStatus === MIC_STATUS.denied;\n    }\n  }, {\n    key: \"query\",\n    get: function get() {\n      return this._query;\n    }\n  }, {\n    key: \"requestPending\",\n    get: function get() {\n      return this.requestStatus === REQUEST_STATUS.pending;\n    }\n  }, {\n    key: \"appbaseSettings\",\n    get: function get() {\n      var _ref4 = this.appbaseConfig || {},\n          recordAnalytics = _ref4.recordAnalytics,\n          customEvents = _ref4.customEvents,\n          enableQueryRules = _ref4.enableQueryRules,\n          userId = _ref4.userId;\n\n      return {\n        recordAnalytics: recordAnalytics,\n        customEvents: customEvents,\n        enableQueryRules: enableQueryRules,\n        userId: userId\n      };\n    } // To get the parsed suggestions from the results\n\n  }, {\n    key: \"suggestions\",\n    get: function get() {\n      if (this.type && this.type !== queryTypes.Search) {\n        return [];\n      }\n\n      if (this.results) {\n        var fields = getNormalizedField(this.dataField) || [];\n\n        if (fields.length === 0 && this.results.data && Array.isArray(this.results.data) && this.results.data.length > 0 && this.results.data[0]) {\n          // Extract fields from _source\n          fields = Object.keys(this.results.data[0]).filter(function (key) {\n            return !['_id', '_click_id', '_index', '_score', '_type'].includes(key);\n          });\n        }\n\n        if (this.enablePopularSuggestions) {\n          // extract suggestions from popular suggestion fields too\n          fields = [].concat(fields, popularSuggestionFields);\n        }\n\n        return getSuggestions(fields, this.results.data, this.value, this.showDistinctSuggestions, this.enablePredictiveSuggestions).slice(0, this.size);\n      }\n\n      return [];\n    } // Method to get the raw query based on the current state\n\n  }, {\n    key: \"componentQuery\",\n    get: function get() {\n      return {\n        id: this.id,\n        type: this.type,\n        dataField: getNormalizedField(this.dataField),\n        react: this.react,\n        highlight: this.highlight,\n        highlightField: getNormalizedField(this.highlightField),\n        fuzziness: this.fuzziness,\n        searchOperators: this.searchOperators,\n        includeFields: this.includeFields,\n        excludeFields: this.excludeFields,\n        size: this.size,\n        from: this.from,\n        queryFormat: this.queryFormat,\n        sortBy: this.sortBy,\n        fieldWeights: getNormalizedWeights(this.dataField),\n        includeNullValues: this.includeNullValues,\n        aggregationField: this.aggregationField,\n        aggregationSize: this.aggregationSize,\n        categoryField: this.categoryField,\n        missingLabel: this.missingLabel,\n        showMissing: this.showMissing,\n        nestedField: this.nestedField,\n        interval: this.interval,\n        customHighlight: this.customHighlight,\n        customQuery: this.customQuery ? this.customQuery(this) : undefined,\n        defaultQuery: this.defaultQuery ? this.defaultQuery(this) : undefined,\n        value: this.value,\n        categoryValue: this.categoryValue,\n        after: this.after,\n        aggregations: this.aggregations,\n        enableSynonyms: this.enableSynonyms,\n        selectAllLabel: this.selectAllLabel,\n        pagination: this.pagination,\n        queryString: this.queryString,\n        distinctField: this.distinctField,\n        distinctFieldConfig: this.distinctFieldConfig,\n        index: this.index\n      };\n    }\n  }, {\n    key: \"queryId\",\n    get: function get() {\n      // Get query ID from parent(searchbase) if exist\n      if (this._parent && this._parent._queryId) {\n        return this._parent._queryId;\n      } // For single components just return the queryId from the component\n\n\n      if (this._queryId) {\n        return this._queryId;\n      }\n\n      return '';\n    }\n  }, {\n    key: \"mappedProps\",\n    get: function get() {\n      var _this5 = this;\n\n      var mappedProps = {};\n      Object.keys(searchBaseMappings).forEach(function (key) {\n        // $FlowFixMe\n        mappedProps[searchBaseMappings[key]] = _this5[key];\n      });\n      return mappedProps;\n    }\n    /* -------- Public methods -------- */\n    // mic click handler\n\n  }]);\n\n  return SearchComponent;\n}(Base);\n/**\n * SearchBase class will act like the ReactiveBase component.\n * It works as a centralized store that will have the info about active/registered components.\n */\n\n\nvar SearchBase = /*#__PURE__*/function (_Base) {\n  _inheritsLoose(SearchBase, _Base);\n  /* ------ Private properties only for the internal use ----------- */\n  // active components\n\n\n  function SearchBase(_ref) {\n    var _this;\n\n    var index = _ref.index,\n        url = _ref.url,\n        credentials = _ref.credentials,\n        headers = _ref.headers,\n        appbaseConfig = _ref.appbaseConfig;\n    _this = _Base.call(this, {\n      index: index,\n      url: url,\n      credentials: credentials,\n      headers: headers,\n      appbaseConfig: appbaseConfig\n    }) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"register\", function (componentId, component) {\n      if (!componentId) {\n        throw new Error(errorMessages.invalidComponentId);\n      }\n\n      if (_this._components[componentId]) {\n        // return existing instance\n        return _this._components[componentId];\n      }\n\n      var componentInstance = component;\n\n      if (component && !(component instanceof SearchComponent)) {\n        // create instance from object with all the options\n        componentInstance = new SearchComponent(_extends({}, component, {\n          id: componentId,\n          index: component.index || _this.index,\n          url: component.url || _this.url,\n          credentials: component.credentials || _this.credentials,\n          headers: component.headers || _this.headers,\n          transformRequest: component.transformRequest || _this.transformRequest,\n          transformResponse: component.transformResponse || _this.transformResponse,\n          appbaseConfig: component.appbaseConfig || _this.appbaseConfig\n        }));\n      } else {\n        // set the id property on instance\n        componentInstance.id = componentId;\n      } // register component\n\n\n      _this._components[componentId] = componentInstance; // set the search base instance as parent\n\n      componentInstance.setParent(_assertThisInitialized(_this));\n      return componentInstance;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"unregister\", function (componentId) {\n      if (componentId) {\n        delete _this._components[componentId];\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getComponent\", function (componentId) {\n      return _this._components[componentId];\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getComponents\", function () {\n      return _this._components;\n    });\n\n    _this._components = {};\n    return _this;\n  } // To register a component\n\n\n  return SearchBase;\n}(Base);\n\nexport { SearchBase, SearchComponent };","map":{"version":3,"sources":["/Users/mohdashraf/Desktop/appbase-apps/recipes-search/node_modules/@appbaseio/searchbase/dist/@appbaseio/searchbase.es.js"],"names":["AppbaseAnalytics","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","Constructor","protoProps","staticProps","prototype","_defineProperty","obj","value","_extends","assign","arguments","source","hasOwnProperty","call","apply","_inheritsLoose","subClass","superClass","create","constructor","__proto__","_objectWithoutPropertiesLoose","excluded","sourceKeys","keys","indexOf","_assertThisInitialized","self","ReferenceError","Observable","observers","_proto","subscribe","fn","propertiesToSubscribe","push","callback","properties","unsubscribe","filter","item","next","o","property","thisObj","scope","window","forEach","undefined","Array","includes","getErrorMessage","msg","errorMessages","invalidIndex","invalidURL","invalidComponentId","invalidDataField","dataFieldAsArray","popularSuggestionFields","queryTypes","Search","Term","Geo","Range","withClickIds","results","map","result","index","_click_id","highlightResults","data","highlight","highlightItem","_extends2","highlightValue","_source","parseHits","hits","concat","reduce","getNormalizedField","field","isArray","fields","dataField","isNumber","n","Number","isNaN","parseFloat","isFinite","getNormalizedWeights","weights","weight","flatReactProp","reactProp","componentID","flattenReact","flatReact","react","r","flatten","arr","flat","toFlatten","extractSuggestion","val","escapeRegExp","string","replace","getPredictiveSuggestions","_ref","suggestions","currentValue","wordsToShowAfterHighlight","suggestionMap","currentValueTrimmed","trim","parsedSuggestion","agg","_ref2","label","rest","parsedContent","DOMParser","parseFromString","documentElement","textContent","regexString","regex","RegExp","regexExecution","exec","matchedString","slice","highlightedWord","split","join","suggestionPhrase","suggestionValue","isPredictiveSuggestion","getSuggestions","showDistinctSuggestions","enablePredictiveSuggestions","suggestionsList","labelsList","skipWordMatch","populateSuggestionsList","parsedSource","isWordMatch","some","term","String","toLowerCase","_promoted","defaultOption","option","parseField","fieldNodes","children","substring","arrayItem","suggestion","traverseSuggestions","parseCompAggToHits","aggFieldName","buckets","bucket","doc_count","_doc_count","_key","isEqual","x","y","p","_p","searchBaseMappings","id","type","queryFormat","categoryField","categoryValue","nestedField","from","size","sortBy","aggregationField","aggregationSize","after","includeNullValues","includeFields","excludeFields","fuzziness","searchOperators","highlightField","customHighlight","interval","aggregations","missingLabel","showMissing","enableSynonyms","selectAllLabel","pagination","queryString","enablePopularSuggestions","error","defaultQuery","customQuery","requestStatus","aggregationData","micStatus","micInstance","micActive","micInactive","micDenied","query","requestPending","appbaseSettings","queryId","recentSearches","distinctField","distinctFieldConfig","onMicClick","triggerDefaultQuery","triggerCustomQuery","recordClick","recordConversions","subscribeToStateChanges","unsubscribeToStateChanges","setDataField","setValue","setSize","setFrom","setFuzziness","setIncludeFields","setExcludeFields","setSortBy","setReact","setDefaultQuery","setCustomQuery","setAfter","btoa","input","chars","str","output","block","charCode","charAt","charCodeAt","Error","Base","url","credentials","headers","appbaseConfig","transformRequest","transformResponse","Accept","Authorization","setHeaders","_analyticsInstance","init","setQueryID","queryID","_queryId","Results","_this","rawResponse","raw","setData","filteredResults","promotedData","ids","_id","Boolean","dataItem","parseResults","get","total","took","hidden","promoted","customData","Aggregations","setRaw","after_key","setAfterKey","afterKey","aggField","append","parsedData","defaultOptions","stateChanges","MIC_STATUS","inactive","active","denied","REQUEST_STATUS","pending","suggestionQueryID","SearchComponent","_Base","beforeValueChange","onValueChange","onResults","onAggregationData","onError","onRequestStatusChange","onQueryChange","onMicStatusChange","maxPopularSuggestions","_results","preserveResults","clearOnQueryChange","rsAPIConfig","micOptions","options","prevStatus","_micStatus","SpeechRecognition","webkitSpeechRecognition","_setMicStatus","_window","_micInstance","_stopMic","continuous","interimResults","start","onstart","onresult","isFinal","_handleVoiceResults","onerror","e","console","prev","_applyOptions","parent","_parent","performUpdate","then","warn","_query","componentQuery","Promise","resolve","handleError","err","_setError","reject","_updateQuery","_setRequestStatus","_fetchRequest","settings","rawResults","afterResponse","_handleAggregationResponse","getSuggestionsQuery","rawPopularSuggestions","popularSuggestionsData","hit","_popular_suggestion","_appendResults","_this$_generateQuery","_generateQuery","requestBody","orderOfQueries","componentInstance","getComponent","_this$_generateQuery2","finalRequest","_prev","objects","isSuggestionClick","click","conversion","queryOptions","minChars","requestOptions","addParam","userId","to","customEvents","fetch","_getSearchIndex","res","status","json","searchObject","_ref3","transcript","stop","_react","_dataField","_from","_size","_sortBy","_value","_after","_includeFields","_excludeFields","_fuzziness","_defaultQuery","_customQuery","execute","_queryString","bool","minimum_should_match","should","function_score","field_value_factor","modifier","missing","multi_match","operator","rawData","prevValue","nextValue","_this$stateChanges$ne","isPopularSuggestionsAPI","_this2","method","body","JSON","stringify","_handleTransformRequest","finalRequestOptions","timestamp","Date","now","suffix","responseHeaders","_handleTransformResponse","transformedData","response","_timestamp","_headers","_this3","components","getComponents","watcherComponents","requestQuery","watcherId","component","dependentComponent","values","aggsResponse","_this4","prevQuery","finalQuery","watcherComponent","watcherQuery","_ref4","recordAnalytics","enableQueryRules","fieldWeights","_this5","mappedProps","SearchBase","componentId","_components","setParent"],"mappings":"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","sourcesContent":["import AppbaseAnalytics from '@appbaseio/analytics';\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nvar Observable = /*#__PURE__*/function () {\n  function Observable() {\n    this.observers = [];\n  }\n\n  var _proto = Observable.prototype;\n\n  _proto.subscribe = function subscribe(fn, propertiesToSubscribe) {\n    this.observers.push({\n      callback: fn,\n      properties: propertiesToSubscribe\n    });\n  };\n\n  _proto.unsubscribe = function unsubscribe(fn) {\n    if (fn) {\n      this.observers = this.observers.filter(function (item) {\n        if (item.callback !== fn) {\n          return item;\n        }\n\n        return null;\n      });\n    } else {\n      this.observers = [];\n    }\n  };\n\n  _proto.next = function next(o, property, thisObj) {\n    var scope = thisObj;\n\n    if (!scope && window) {\n      scope = window;\n    }\n\n    this.observers.forEach(function (item) {\n      // filter by subscribed properties\n      if (item.properties === undefined) {\n        item.callback.call(scope, o);\n      } else if (item.properties instanceof Array && item.properties.length && item.properties.includes(property)) {\n        item.callback.call(scope, o);\n      } else if (typeof item.properties === 'string' && item.properties && item.properties === property) {\n        item.callback.call(scope, o);\n      }\n    });\n  };\n\n  return Observable;\n}();\n\nfunction getErrorMessage(msg) {\n  return \"SearchBase: \" + msg;\n}\nvar errorMessages = {\n  invalidIndex: getErrorMessage('Please provide a valid index.'),\n  invalidURL: getErrorMessage('Please provide a valid url.'),\n  invalidComponentId: getErrorMessage('Please provide component id.'),\n  invalidDataField: getErrorMessage('Please provide data field.'),\n  dataFieldAsArray: getErrorMessage('Only components with `search` type supports the multiple data fields. Please define `dataField` as a string.')\n};\nvar popularSuggestionFields = ['key', 'key.autosuggest'];\nvar queryTypes = {\n  Search: 'search',\n  Term: 'term',\n  Geo: 'geo',\n  Range: 'range'\n};\nvar withClickIds = function withClickIds(results) {\n  if (results === void 0) {\n    results = [];\n  }\n\n  return results.map(function (result, index) {\n    return _extends({}, result, {\n      _click_id: index + 1\n    });\n  });\n};\nvar highlightResults = function highlightResults(result) {\n  var data = _extends({}, result);\n\n  if (data.highlight) {\n    Object.keys(data.highlight).forEach(function (highlightItem) {\n      var _extends2;\n\n      var highlightValue = data.highlight[highlightItem][0];\n      data._source = _extends({}, data._source, (_extends2 = {}, _extends2[highlightItem] = highlightValue, _extends2));\n    });\n  }\n\n  return data;\n};\nvar parseHits = function parseHits(hits) {\n  var results = [];\n\n  if (hits) {\n    results = [].concat(hits).map(function (item) {\n      var data = highlightResults(item);\n      var result = Object.keys(data).filter(function (key) {\n        return key !== '_source';\n      }).reduce(function (obj, key) {\n        // eslint-disable-next-line\n        obj[key] = data[key];\n        return obj;\n      }, _extends({}, data._source));\n      return result;\n    });\n  }\n\n  return results;\n};\nvar getNormalizedField = function getNormalizedField(field) {\n  if (field) {\n    // if data field is string\n    if (!Array.isArray(field)) {\n      return [field];\n    }\n\n    if (field.length) {\n      var fields = [];\n      field.forEach(function (dataField) {\n        if (typeof dataField === 'string') {\n          fields.push(dataField);\n        } else if (dataField.field) {\n          // if data field is an array of objects\n          fields.push(dataField.field);\n        }\n      });\n      return fields;\n    }\n  }\n\n  return undefined;\n};\nfunction isNumber(n) {\n  return !Number.isNaN(parseFloat(n)) && Number.isFinite(n);\n}\nvar getNormalizedWeights = function getNormalizedWeights(field) {\n  if (field && Array.isArray(field) && field.length) {\n    var weights = [];\n    field.forEach(function (dataField) {\n      if (isNumber(dataField.weight)) {\n        // if data field is an array of objects\n        weights.push(dataField.weight);\n      } else {\n        // Add default weight as 1 to maintain order\n        weights.push(1);\n      }\n    });\n    return weights;\n  }\n\n  return undefined;\n};\nfunction flatReactProp(reactProp, componentID) {\n  var flattenReact = [];\n\n  var flatReact = function flatReact(react) {\n    if (react && Object.keys(react)) {\n      Object.keys(react).forEach(function (r) {\n        if (react[r]) {\n          if (typeof react[r] === 'string') {\n            flattenReact = [].concat(flattenReact, [react[r]]);\n          } else if (Array.isArray(react[r])) {\n            flattenReact = [].concat(flattenReact, react[r]);\n          } else if (typeof react[r] === 'object') {\n            flatReact(react[r]);\n          }\n        }\n      });\n    }\n  };\n\n  flatReact(reactProp); // Remove cyclic dependencies i.e dependencies on it's own\n\n  flattenReact = flattenReact.filter(function (react) {\n    return react !== componentID;\n  });\n  return flattenReact;\n} // flattens a nested array\n\nvar flatten = function flatten(arr) {\n  return arr.reduce(function (flat, toFlatten) {\n    return flat.concat(Array.isArray(toFlatten) ? flatten(toFlatten) : toFlatten);\n  }, []);\n}; // helper function to extract suggestions\n\nvar extractSuggestion = function extractSuggestion(val) {\n  if (typeof val === 'object') {\n    if (Array.isArray(val)) {\n      return flatten(val);\n    }\n\n    return null;\n  }\n\n  return val;\n};\n\nfunction escapeRegExp(string) {\n  if (string === void 0) {\n    string = '';\n  }\n\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n\nvar getPredictiveSuggestions = function getPredictiveSuggestions(_ref) {\n  var suggestions = _ref.suggestions,\n      currentValue = _ref.currentValue,\n      wordsToShowAfterHighlight = _ref.wordsToShowAfterHighlight;\n  var suggestionMap = {};\n\n  if (currentValue) {\n    var currentValueTrimmed = currentValue.trim();\n    var parsedSuggestion = suggestions.reduce(function (agg, _ref2) {\n      var label = _ref2.label,\n          rest = _objectWithoutPropertiesLoose(_ref2, [\"label\"]);\n\n      // to handle special strings with pattern '<mark>xyz</mark> <a href=\"test'\n      var parsedContent = new DOMParser().parseFromString(label, 'text/html').documentElement.textContent; // to match the partial start of word.\n      // example if searchTerm is `select` and string contains `selected`\n\n      var regexString = \"^(\" + escapeRegExp(currentValueTrimmed) + \")\\\\w+\";\n      var regex = new RegExp(regexString, 'i');\n      var regexExecution = regex.exec(parsedContent); // if execution value is null it means either there is no match or there are chances\n      // that exact word is present\n\n      if (!regexExecution) {\n        // regex to match exact word\n        regexString = \"^(\" + escapeRegExp(currentValueTrimmed) + \")\";\n        regex = new RegExp(regexString, 'i');\n        regexExecution = regex.exec(parsedContent);\n      }\n\n      if (regexExecution) {\n        var matchedString = parsedContent.slice(regexExecution.index, parsedContent.length);\n        var highlightedWord = matchedString.slice(currentValueTrimmed.length).split(' ').slice(0, wordsToShowAfterHighlight + 1).join(' ');\n        var suggestionPhrase = currentValueTrimmed + \"<mark class=\\\"highlight\\\">\" + highlightedWord + \"</mark>\";\n        var suggestionValue = \"\" + currentValueTrimmed + highlightedWord; // to show unique results only\n\n        if (!suggestionMap[suggestionPhrase]) {\n          suggestionMap[suggestionPhrase] = 1;\n          return [].concat(agg, [_extends({}, rest, {\n            label: suggestionPhrase,\n            value: suggestionValue,\n            isPredictiveSuggestion: true\n          })]);\n        }\n\n        return agg;\n      }\n\n      return agg;\n    }, []);\n    return parsedSuggestion;\n  }\n\n  return [];\n};\n/**\n *\n * @param {array} fields DataFields passed on Search Components\n * @param {array} suggestions Raw Suggestions received from ES\n * @param {string} currentValue Search Term\n * @param {boolean} showDistinctSuggestions When set to true will only return 1 suggestion per document\n * @param {boolean} enablePredictiveSuggestions When set to true will return the predictive suggestions list instead of the deafult list\n */\n\nvar getSuggestions = function getSuggestions(fields, suggestions, value, showDistinctSuggestions, enablePredictiveSuggestions) {\n  if (fields === void 0) {\n    fields = [];\n  }\n\n  if (value === void 0) {\n    value = '';\n  }\n\n  if (showDistinctSuggestions === void 0) {\n    showDistinctSuggestions = true;\n  }\n\n  if (enablePredictiveSuggestions === void 0) {\n    enablePredictiveSuggestions = false;\n  }\n\n  var suggestionsList = [];\n  var labelsList = [];\n  var skipWordMatch = false; //  Use to skip the word match logic, important for synonym\n\n  var currentValue = value || '';\n\n  var populateSuggestionsList = function populateSuggestionsList(val, parsedSource, source) {\n    // check if the suggestion includes the current value\n    // and not already included in other suggestions\n    var isWordMatch = skipWordMatch || currentValue.trim().split(' ').some(function (term) {\n      return String(val).toLowerCase().includes(term);\n    }); // promoted results should always include in suggestions even there is no match\n\n    if (isWordMatch && !labelsList.includes(val) || source._promoted) {\n      var defaultOption = {\n        label: val,\n        value: val,\n        source: source\n      };\n\n      var option = _extends({}, defaultOption);\n\n      labelsList = [].concat(labelsList, [val]);\n      suggestionsList = [].concat(suggestionsList, [option]);\n\n      if (showDistinctSuggestions) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var parseField = function parseField(parsedSource, field, source) {\n    if (field === void 0) {\n      field = '';\n    }\n\n    if (source === void 0) {\n      source = parsedSource;\n    }\n\n    if (typeof parsedSource === 'object') {\n      var fieldNodes = field.split('.');\n      var label = parsedSource[fieldNodes[0]];\n\n      if (label) {\n        if (fieldNodes.length > 1) {\n          // nested fields of the 'foo.bar.zoo' variety\n          var children = field.substring(fieldNodes[0].length + 1);\n\n          if (Array.isArray(label)) {\n            label.forEach(function (arrayItem) {\n              parseField(arrayItem, children, source);\n            });\n          } else {\n            parseField(label, children, source);\n          }\n        } else {\n          var val = extractSuggestion(label);\n\n          if (val) {\n            if (Array.isArray(val)) {\n              if (showDistinctSuggestions) {\n                return val.some(function (suggestion) {\n                  return populateSuggestionsList(suggestion, parsedSource, source);\n                });\n              }\n\n              val.forEach(function (suggestion) {\n                return populateSuggestionsList(suggestion, parsedSource, source);\n              });\n            }\n\n            return populateSuggestionsList(val, parsedSource, source);\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var traverseSuggestions = function traverseSuggestions() {\n    if (showDistinctSuggestions) {\n      suggestions.forEach(function (item) {\n        fields.some(function (field) {\n          return parseField(item, field);\n        });\n      });\n    } else {\n      suggestions.forEach(function (item) {\n        fields.forEach(function (field) {\n          parseField(item, field);\n        });\n      });\n    }\n  };\n\n  traverseSuggestions();\n\n  if (suggestionsList.length < suggestions.length && !skipWordMatch) {\n    /*\n    When we have synonym we set skipWordMatch to false as it may discard\n    the suggestion if word doesnt match term.\n    For eg: iphone, ios are synonyms and on searching iphone isWordMatch\n    in  populateSuggestionList may discard ios source which decreases no.\n    of items in suggestionsList\n    */\n    skipWordMatch = true;\n    traverseSuggestions();\n  }\n\n  if (enablePredictiveSuggestions) {\n    return getPredictiveSuggestions({\n      suggestions: suggestionsList,\n      currentValue: value,\n      wordsToShowAfterHighlight: true\n    });\n  }\n\n  return suggestionsList;\n};\nfunction parseCompAggToHits(aggFieldName, buckets) {\n  if (buckets === void 0) {\n    buckets = [];\n  }\n\n  return buckets.map(function (bucket) {\n    // eslint-disable-next-line camelcase\n    var doc_count = bucket.doc_count,\n        key = bucket.key,\n        data = bucket[aggFieldName];\n    return _extends({\n      _doc_count: doc_count,\n      // To handle the aggregation results for term and composite aggs\n      _key: key[aggFieldName] !== undefined ? key[aggFieldName] : key\n    }, data);\n  });\n}\nfunction isEqual(x, y) {\n  if (x === y) return true;\n  if (!(x instanceof Object) || !(y instanceof Object)) return false;\n  if (x.constructor !== y.constructor) return false;\n  /* eslint-disable */\n\n  for (var p in x) {\n    if (!x.hasOwnProperty(p)) continue;\n    if (!y.hasOwnProperty(p)) return false;\n    if (x[p] === y[p]) continue;\n    if (typeof x[p] !== 'object') return false;\n    if (!isEqual(x[p], y[p])) return false;\n  }\n\n  for (var _p in y) {\n    if (y.hasOwnProperty(_p) && !x.hasOwnProperty(_p)) return false;\n  }\n  /* eslint-enable */\n\n\n  return true;\n}\nvar searchBaseMappings = {\n  id: 'id',\n  type: 'type',\n  react: 'react',\n  queryFormat: 'queryFormat',\n  dataField: 'dataField',\n  categoryField: 'categoryField',\n  categoryValue: 'categoryValue',\n  nestedField: 'nestedField',\n  from: 'from',\n  size: 'size',\n  sortBy: 'sortBy',\n  value: 'value',\n  aggregationField: 'aggregationField',\n  aggregationSize: 'aggregationSize',\n  after: 'after',\n  includeNullValues: 'includeNullValues',\n  includeFields: 'includeFields',\n  excludeFields: 'excludeFields',\n  fuzziness: 'fuzziness',\n  searchOperators: 'searchOperators',\n  highlight: 'highlight',\n  highlightField: 'highlightField',\n  customHighlight: 'customHighlight',\n  interval: 'interval',\n  aggregations: 'aggregations',\n  missingLabel: 'missingLabel',\n  showMissing: 'showMissing',\n  enableSynonyms: 'enableSynonyms',\n  selectAllLabel: 'selectAllLabel',\n  pagination: 'pagination',\n  queryString: 'queryString',\n  enablePopularSuggestions: 'enablePopularSuggestions',\n  showDistinctSuggestions: 'showDistinctSuggestions',\n  error: 'error',\n  defaultQuery: 'defaultQuery',\n  customQuery: 'customQuery',\n  requestStatus: 'requestStatus',\n  results: 'results',\n  aggregationData: 'aggregationData',\n  micStatus: 'micStatus',\n  micInstance: 'micInstance',\n  micActive: 'micActive',\n  micInactive: 'micInactive',\n  micDenied: 'micDenied',\n  query: 'query',\n  requestPending: 'loading',\n  appbaseSettings: 'appbaseConfig',\n  suggestions: 'suggestions',\n  queryId: 'queryId',\n  recentSearches: 'recentSearches',\n  distinctField: 'distinctField',\n  distinctFieldConfig: 'distinctFieldConfig',\n  // ---------------- Methods -----------------------\n  onMicClick: 'handleMicClick',\n  triggerDefaultQuery: 'triggerDefaultQuery',\n  triggerCustomQuery: 'triggerCustomQuery',\n  recordClick: 'recordClick',\n  recordConversions: 'recordConversions',\n  subscribeToStateChanges: 'subscribeToStateChanges',\n  unsubscribeToStateChanges: 'unsubscribeToStateChanges',\n  // ---------------- Setter Methods ----------------\n  setDataField: 'setDataField',\n  setValue: 'setValue',\n  setSize: 'setSize',\n  setFrom: 'setFrom',\n  setFuzziness: 'setFuzziness',\n  setIncludeFields: 'setIncludeFields',\n  setExcludeFields: 'setExcludeFields',\n  setSortBy: 'setSortBy',\n  setReact: 'setReact',\n  setDefaultQuery: 'setDefaultQuery',\n  setCustomQuery: 'setCustomQuery',\n  setAfter: 'setAfter'\n};\nfunction btoa(input) {\n  if (input === void 0) {\n    input = '';\n  }\n\n  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';\n  var str = input;\n  var output = ''; // eslint-disable-next-line\n\n  for (var block = 0, charCode, i = 0, map = chars; str.charAt(i | 0) || (map = '=', i % 1); // eslint-disable-line no-bitwise\n  output += map.charAt(63 & block >> 8 - i % 1 * 8) // eslint-disable-line no-bitwise\n  ) {\n    charCode = str.charCodeAt(i += 3 / 4);\n\n    if (charCode > 0xff) {\n      throw new Error('\"btoa\" failed: The string to be encoded contains characters outside of the Latin1 range.');\n    }\n\n    block = block << 8 | charCode; // eslint-disable-line no-bitwise\n  }\n\n  return output;\n}\n\n/**\n * Base class is the abstract class for SearchBase and SearchComponent classes.\n */\nvar Base = /*#__PURE__*/function () {\n  // to enable the recording of analytics\n  // auth credentials if any\n  // custom headers object\n  // es index name\n  // es url\n\n  /* ---- callbacks to create the side effects while querying ----- */\n\n  /* ------ Private properties only for the internal use ----------- */\n  // analytics instance\n  // query search ID\n  function Base(_ref) {\n    var index = _ref.index,\n        url = _ref.url,\n        credentials = _ref.credentials,\n        headers = _ref.headers,\n        appbaseConfig = _ref.appbaseConfig,\n        transformRequest = _ref.transformRequest,\n        transformResponse = _ref.transformResponse;\n\n    if (!index) {\n      throw new Error(errorMessages.invalidIndex);\n    }\n\n    if (!url) {\n      throw new Error(errorMessages.invalidURL);\n    }\n\n    this.index = index;\n    this.url = url;\n    this.credentials = credentials || '';\n\n    if (appbaseConfig) {\n      this.appbaseConfig = appbaseConfig;\n    }\n\n    if (transformRequest) {\n      this.transformRequest = transformRequest;\n    }\n\n    if (transformResponse) {\n      this.transformResponse = transformResponse;\n    } // Initialize headers\n\n\n    this.headers = {\n      Accept: 'application/json',\n      'Content-Type': 'application/json'\n    };\n\n    if (this.credentials) {\n      this.headers = _extends({}, this.headers, {\n        Authorization: \"Basic \" + btoa(this.credentials)\n      });\n    }\n\n    if (headers) {\n      this.setHeaders(headers);\n    } // Create analytics index\n\n\n    this._analyticsInstance = AppbaseAnalytics.init({\n      index: index,\n      url: url,\n      credentials: credentials\n    });\n  } // To to set the custom headers\n\n\n  var _proto = Base.prototype;\n\n  _proto.setHeaders = function setHeaders(headers) {\n    this.headers = _extends({}, this.headers, headers);\n  } // To set the query ID\n  ;\n\n  _proto.setQueryID = function setQueryID(queryID) {\n    this._queryId = queryID;\n  };\n\n  return Base;\n}();\n\nvar Results = /*#__PURE__*/function () {\n  // An array of results obtained from the applied query.\n  // Raw response returned by ES query\n  // Results parser\n  function Results(data) {\n    var _this = this;\n\n    _defineProperty(this, \"setRaw\", function (rawResponse) {\n      // set response\n      _this.raw = rawResponse;\n\n      if (rawResponse.hits && rawResponse.hits.hits) {\n        _this.setData(rawResponse.hits.hits);\n      }\n    });\n\n    this.data = data || [];\n  } // Total number of results found\n\n\n  var _proto = Results.prototype;\n\n  // Method to set data explicitly\n  _proto.setData = function setData(data) {\n    // parse hits\n    var filteredResults = parseHits(data); // filter results & remove duplicates if any\n\n    if (this.promotedData.length) {\n      var ids = this.promotedData.map(function (item) {\n        return item._id;\n      }).filter(Boolean);\n\n      if (ids) {\n        filteredResults = filteredResults.filter(function (item) {\n          return !ids.includes(item._id);\n        });\n      }\n\n      filteredResults = [].concat(this.promotedData.map(function (dataItem) {\n        return _extends({}, dataItem, {\n          _promoted: true\n        });\n      }), filteredResults);\n    } // set data\n\n\n    if (this.parseResults) {\n      this.data = this.parseResults(filteredResults, data);\n    } else {\n      this.data = filteredResults;\n    } // Add click ids in data\n\n\n    this.data = withClickIds(this.data);\n  };\n\n  _createClass(Results, [{\n    key: \"numberOfResults\",\n    get: function get() {\n      // calculate from raw response\n      if (this.raw && this.raw.hits) {\n        return typeof this.raw.hits.total === 'object' ? this.raw.hits.total.value : this.raw.hits.total;\n      }\n\n      return 0;\n    } // Total time taken by request (in ms)\n\n  }, {\n    key: \"time\",\n    get: function get() {\n      // calculate from raw response\n      if (this.raw) {\n        return this.raw.took;\n      }\n\n      return 0;\n    } // no of hidden results found\n\n  }, {\n    key: \"hidden\",\n    get: function get() {\n      if (this.raw && this.raw.hits) {\n        return this.raw.hits.hidden || 0;\n      }\n\n      return 0;\n    } // An array of promoted results obtained from the applied query.\n\n  }, {\n    key: \"promotedData\",\n    get: function get() {\n      if (this.raw && this.raw.promoted) {\n        return this.raw.promoted || [];\n      }\n\n      return [];\n    } // no of promoted results found\n\n  }, {\n    key: \"promoted\",\n    get: function get() {\n      return this.promotedData.length || 0;\n    } // An object of raw response as-is from elasticsearch query\n\n  }, {\n    key: \"rawData\",\n    get: function get() {\n      return this.raw || {};\n    } // object of custom data applied through queryRules\n    // only works when `enableAppbase=true`\n\n  }, {\n    key: \"customData\",\n    get: function get() {\n      if (this.raw && this.raw.customData) {\n        return this.raw.customData || {};\n      }\n\n      return {};\n    }\n  }]);\n\n  return Results;\n}();\n\nvar Aggregations = /*#__PURE__*/function () {\n  // An array of composite aggregations obtained from the applied aggs in options.\n  // useful when loading data of greater size\n  // Raw aggregations returned by ES query\n  function Aggregations(data) {\n    this.data = data || [];\n  } // An object of raw response as-is from elasticsearch query\n\n\n  var _proto = Aggregations.prototype;\n\n  _proto.setRaw = function setRaw(rawResponse) {\n    // set response\n    this.raw = rawResponse;\n    if (rawResponse.after_key) this.setAfterKey(rawResponse.after_key);\n  };\n\n  _proto.setAfterKey = function setAfterKey(key) {\n    this.afterKey = key;\n  } // Method to set data explicitly\n  ;\n\n  _proto.setData = function setData(aggField, data, append) {\n    if (append === void 0) {\n      append = false;\n    }\n\n    // parse aggregation buckets\n    var parsedData = parseCompAggToHits(aggField, data); // Merge data\n\n    if (append) {\n      this.data = [].concat(this.data, parsedData);\n    } else {\n      this.data = parsedData;\n    }\n  };\n\n  _createClass(Aggregations, [{\n    key: \"rawData\",\n    get: function get() {\n      return this.raw || {};\n    }\n  }]);\n\n  return Aggregations;\n}();\n\nvar defaultOptions = {\n  triggerDefaultQuery: true,\n  triggerCustomQuery: false,\n  stateChanges: true\n};\nvar defaultOption = {\n  stateChanges: true\n};\nvar MIC_STATUS = {\n  inactive: 'INACTIVE',\n  active: 'ACTIVE',\n  denied: 'DENIED'\n};\nvar REQUEST_STATUS = {\n  inactive: 'INACTIVE',\n  pending: 'PENDING',\n  error: 'ERROR'\n};\nvar suggestionQueryID = 'DataSearch__suggestions';\n/**\n * SearchComponent class is responsible for the following things:\n * - It provides the methods to trigger the query\n * - It maintains the request state for e.g loading, error etc.\n * - It handles the `custom` and `default` queries\n * - Basically the SearchComponent class provides all the utilities to build any ReactiveSearch component\n */\n\nvar SearchComponent = /*#__PURE__*/function (_Base) {\n  _inheritsLoose(SearchComponent, _Base);\n\n  // RS API properties\n  // other properties\n  // To enable the popular suggestions\n  // size of the popular suggestions\n  // To show the distinct suggestions\n  // To show the predictive suggestions\n  // preserve the data for infinite loading\n  // to clear the dependent facets values on query change\n  // query error\n  // state changes subject\n  // request status\n  // results\n  // aggregations\n  // recent searches\n\n  /* ------ Private properties only for the internal use ----------- */\n  // Counterpart of the query\n  // TODO: Check on the below properties\n  // mic status\n  // mic instance\n  // query search ID\n\n  /* ---- callbacks to create the side effects while querying ----- */\n\n  /* ------------- change events -------------------------------- */\n  // called when value changes\n  // called when results change\n  // called when composite aggregationData change\n  // called when there is an error while fetching results\n  // called when request status changes\n  // called when query changes\n  // called when mic status changes\n  function SearchComponent(_ref) {\n    var _this;\n\n    var index = _ref.index,\n        url = _ref.url,\n        credentials = _ref.credentials,\n        appbaseConfig = _ref.appbaseConfig,\n        headers = _ref.headers,\n        transformRequest = _ref.transformRequest,\n        transformResponse = _ref.transformResponse,\n        beforeValueChange = _ref.beforeValueChange,\n        onValueChange = _ref.onValueChange,\n        onResults = _ref.onResults,\n        onAggregationData = _ref.onAggregationData,\n        onError = _ref.onError,\n        onRequestStatusChange = _ref.onRequestStatusChange,\n        onQueryChange = _ref.onQueryChange,\n        onMicStatusChange = _ref.onMicStatusChange,\n        enablePopularSuggestions = _ref.enablePopularSuggestions,\n        maxPopularSuggestions = _ref.maxPopularSuggestions,\n        _results = _ref.results,\n        showDistinctSuggestions = _ref.showDistinctSuggestions,\n        enablePredictiveSuggestions = _ref.enablePredictiveSuggestions,\n        preserveResults = _ref.preserveResults,\n        clearOnQueryChange = _ref.clearOnQueryChange,\n        rsAPIConfig = _objectWithoutPropertiesLoose(_ref, [\"index\", \"url\", \"credentials\", \"appbaseConfig\", \"headers\", \"transformRequest\", \"transformResponse\", \"beforeValueChange\", \"onValueChange\", \"onResults\", \"onAggregationData\", \"onError\", \"onRequestStatusChange\", \"onQueryChange\", \"onMicStatusChange\", \"enablePopularSuggestions\", \"maxPopularSuggestions\", \"results\", \"showDistinctSuggestions\", \"enablePredictiveSuggestions\", \"preserveResults\", \"clearOnQueryChange\"]);\n\n    _this = _Base.call(this, {\n      index: index,\n      url: url,\n      credentials: credentials,\n      headers: headers,\n      appbaseConfig: appbaseConfig,\n      transformRequest: transformRequest,\n      transformResponse: transformResponse\n    }) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"onMicClick\", function (micOptions, options) {\n      if (micOptions === void 0) {\n        micOptions = {};\n      }\n\n      if (options === void 0) {\n        options = {\n          triggerDefaultQuery: false,\n          triggerCustomQuery: false,\n          stateChanges: true\n        };\n      }\n\n      var prevStatus = _this._micStatus;\n\n      if (typeof window !== 'undefined') {\n        window.SpeechRecognition = window.webkitSpeechRecognition || window.SpeechRecognition || null;\n      }\n\n      if (window && window.SpeechRecognition && prevStatus !== MIC_STATUS.denied) {\n        if (prevStatus === MIC_STATUS.active) {\n          _this._setMicStatus(MIC_STATUS.inactive, options);\n        }\n\n        var _window = window,\n            SpeechRecognition = _window.SpeechRecognition;\n\n        if (_this._micInstance) {\n          _this._stopMic();\n\n          return;\n        }\n\n        _this._micInstance = new SpeechRecognition();\n        _this._micInstance.continuous = true;\n        _this._micInstance.interimResults = true;\n        Object.assign(_this._micInstance, micOptions);\n\n        _this._micInstance.start();\n\n        _this._micInstance.onstart = function () {\n          _this._setMicStatus(MIC_STATUS.active, options);\n        };\n\n        _this._micInstance.onresult = function (_ref2) {\n          var results = _ref2.results;\n\n          if (results && results[0] && results[0].isFinal) {\n            _this._stopMic();\n          }\n\n          _this._handleVoiceResults({\n            results: results\n          }, options);\n        };\n\n        _this._micInstance.onerror = function (e) {\n          if (e.error === 'no-speech' || e.error === 'audio-capture') {\n            _this._setMicStatus(MIC_STATUS.inactive, options);\n          } else if (e.error === 'not-allowed') {\n            _this._setMicStatus(MIC_STATUS.denied, options);\n          }\n\n          console.error(e);\n        };\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setDataField\", function (dataField, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.dataField;\n      _this.dataField = dataField;\n\n      _this._applyOptions(options, 'dataField', prev, dataField);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setParent\", function (parent) {\n      _this._parent = parent;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setValue\", function (value, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var performUpdate = function performUpdate() {\n        var prev = _this.value;\n        _this.value = value;\n\n        _this._applyOptions(options, 'value', prev, _this.value);\n      };\n\n      if (_this.beforeValueChange) {\n        _this.beforeValueChange(value).then(performUpdate)[\"catch\"](function (e) {\n          console.warn('beforeValueChange rejected the promise with ', e);\n        });\n      } else {\n        performUpdate();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSize\", function (size, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.size;\n      _this.size = size;\n\n      _this._applyOptions(options, 'size', prev, _this.size);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setFrom\", function (from, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.from;\n      _this.from = from;\n\n      _this._applyOptions(options, 'from', prev, _this.from);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setFuzziness\", function (fuzziness, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.fuzziness;\n      _this.fuzziness = fuzziness;\n\n      _this._applyOptions(options, 'fuzziness', prev, _this.fuzziness);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setIncludeFields\", function (includeFields, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.includeFields;\n      _this.includeFields = includeFields;\n\n      _this._applyOptions(options, 'includeFields', prev, includeFields);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setExcludeFields\", function (excludeFields, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.excludeFields;\n      _this.excludeFields = excludeFields;\n\n      _this._applyOptions(options, 'excludeFields', prev, excludeFields);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setSortBy\", function (sortBy, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.sortBy;\n      _this.sortBy = sortBy;\n\n      _this._applyOptions(options, 'sortBy', prev, sortBy);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setReact\", function (react, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.react;\n      _this.react = react;\n\n      _this._applyOptions(options, 'react', prev, react);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setDefaultQuery\", function (defaultQuery, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.defaultQuery;\n      _this.defaultQuery = defaultQuery;\n\n      _this._applyOptions(options, 'defaultQuery', prev, defaultQuery);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setCustomQuery\", function (customQuery, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.customQuery;\n      _this.customQuery = customQuery;\n\n      _this._applyOptions(options, 'customQuery', prev, customQuery);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"setAfter\", function (after, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prev = _this.after;\n      _this.after = after;\n\n      _this.aggregationData.setAfterKey(after);\n\n      _this._applyOptions(options, 'after', prev, after);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"triggerDefaultQuery\", function (options) {\n      if (options === void 0) {\n        options = defaultOption;\n      }\n\n      // To prevent duplicate queries\n      if (isEqual(_this._query, _this.componentQuery)) {\n        return Promise.resolve(true);\n      }\n\n      var handleError = function handleError(err) {\n        _this._setError(err, {\n          stateChanges: options.stateChanges\n        });\n\n        console.error(err);\n        return Promise.reject(err);\n      };\n\n      try {\n        _this._updateQuery();\n\n        _this._setRequestStatus(REQUEST_STATUS.pending);\n\n        return _this._fetchRequest({\n          query: Array.isArray(_this.query) ? _this.query : [_this.query],\n          settings: _this.appbaseSettings\n        }).then(function (results) {\n          var prev = _this.results;\n          var rawResults = results && results[_this.id];\n\n          var afterResponse = function afterResponse() {\n            if (rawResults.aggregations) {\n              _this._handleAggregationResponse(rawResults.aggregations, _extends({\n                defaultOptions: defaultOptions\n              }, options));\n            }\n\n            _this._setRequestStatus(REQUEST_STATUS.inactive);\n\n            _this._applyOptions({\n              stateChanges: options.stateChanges\n            }, 'results', prev, _this.results);\n          };\n\n          if ((!_this.type || _this.type === queryTypes.Search) && _this.enablePopularSuggestions) {\n            _this._fetchRequest(_this.getSuggestionsQuery(), true).then(function (rawPopularSuggestions) {\n              var popularSuggestionsData = rawPopularSuggestions[suggestionQueryID]; // Merge popular suggestions as the top suggestions\n\n              if (popularSuggestionsData && popularSuggestionsData.hits && popularSuggestionsData.hits.hits && rawResults.hits && rawResults.hits.hits) {\n                rawResults.hits.hits = [].concat((popularSuggestionsData.hits.hits || []).map(function (hit) {\n                  return _extends({}, hit, {\n                    // Set the popular suggestion tag for suggestion hits\n                    _popular_suggestion: true\n                  });\n                }), rawResults.hits.hits);\n              }\n\n              _this._appendResults(rawResults);\n\n              afterResponse();\n            })[\"catch\"](handleError);\n          } else {\n            _this._appendResults(rawResults);\n\n            afterResponse();\n          }\n\n          return Promise.resolve(rawResults);\n        })[\"catch\"](handleError);\n      } catch (err) {\n        return handleError(err);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"triggerCustomQuery\", function (options) {\n      if (options === void 0) {\n        options = defaultOption;\n      }\n\n      // Generate query again after resetting changes\n      var _this$_generateQuery = _this._generateQuery(),\n          requestBody = _this$_generateQuery.requestBody,\n          orderOfQueries = _this$_generateQuery.orderOfQueries;\n\n      if (requestBody.length) {\n        if (isEqual(_this._query, requestBody)) {\n          return Promise.resolve(true);\n        }\n\n        var handleError = function handleError(err) {\n          _this._setError(err, {\n            stateChanges: options.stateChanges\n          });\n\n          console.error(err);\n          return Promise.reject(err);\n        };\n\n        try {\n          // set the request loading to true for all the requests\n          orderOfQueries.forEach(function (id) {\n            var componentInstance = _this._parent.getComponent(id);\n\n            if (componentInstance) {\n              // Reset `from` and `after` values\n              componentInstance.setFrom(0, {\n                stateChanges: true,\n                triggerDefaultQuery: false,\n                triggerCustomQuery: false\n              });\n              componentInstance.setAfter(undefined, {\n                stateChanges: true,\n                triggerDefaultQuery: false,\n                triggerCustomQuery: false\n              }); // Reset value for dependent components after fist query is made\n              // We wait for first query to not clear filters applied by URL params\n\n              if (_this.clearOnQueryChange && _this._query) {\n                componentInstance.setValue(undefined, {\n                  stateChanges: true,\n                  triggerDefaultQuery: false,\n                  triggerCustomQuery: false\n                });\n              }\n\n              componentInstance._setRequestStatus(REQUEST_STATUS.pending); // Update the query\n\n\n              componentInstance._updateQuery();\n            }\n          }); // Re-generate query after changes\n\n          var _this$_generateQuery2 = _this._generateQuery(),\n              finalRequest = _this$_generateQuery2.requestBody;\n\n          return _this._fetchRequest({\n            query: finalRequest,\n            settings: _this.appbaseSettings\n          }).then(function (results) {\n            // Update the state for components\n            orderOfQueries.forEach(function (id) {\n              var componentInstance = _this._parent.getComponent(id);\n\n              if (componentInstance) {\n                componentInstance._setRequestStatus(REQUEST_STATUS.inactive); // Update the results\n\n\n                var _prev = componentInstance.results; // Collect results from the response for a particular component\n\n                var rawResults = results && results[id]; // Set results\n\n                if (rawResults.hits) {\n                  componentInstance.results.setRaw(rawResults);\n\n                  componentInstance._applyOptions({\n                    stateChanges: options.stateChanges\n                  }, 'results', _prev, componentInstance.results);\n                }\n\n                if (rawResults.aggregations) {\n                  componentInstance._handleAggregationResponse(rawResults.aggregations, _extends({\n                    defaultOptions: defaultOptions\n                  }, options), false);\n                }\n              }\n            });\n            return Promise.resolve(results);\n          })[\"catch\"](handleError);\n        } catch (err) {\n          return handleError(err);\n        }\n      } else {\n        return Promise.resolve({});\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"recordClick\", function (objects, isSuggestionClick) {\n      if (isSuggestionClick === void 0) {\n        isSuggestionClick = false;\n      }\n\n      if (_this._analyticsInstance && _this.queryId) {\n        _this._analyticsInstance.click({\n          queryID: _this.queryId,\n          objects: objects,\n          isSuggestionClick: isSuggestionClick\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"recordConversions\", function (objects) {\n      if (_this._analyticsInstance && _this.queryId) {\n        _this._analyticsInstance.conversion({\n          queryID: _this.queryId,\n          objects: objects\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"subscribeToStateChanges\", function (fn, propertiesToSubscribe) {\n      _this.stateChanges.subscribe(fn, propertiesToSubscribe);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"unsubscribeToStateChanges\", function (fn) {\n      _this.stateChanges.unsubscribe(fn);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"clearResults\", function (options) {\n      if (options === void 0) {\n        options = defaultOption;\n      }\n\n      var prev = _this.results;\n\n      _this.results.setRaw({\n        hits: {\n          hits: []\n        }\n      });\n\n      _this._applyOptions({\n        stateChanges: options.stateChanges\n      }, 'results', prev, _this.results);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getRecentSearches\", function (queryOptions, options) {\n      if (queryOptions === void 0) {\n        queryOptions = {\n          size: 5,\n          minChars: 3\n        };\n      }\n\n      if (options === void 0) {\n        options = defaultOption;\n      }\n\n      var requestOptions = {\n        headers: _extends({}, _this.headers)\n      };\n      var queryString = '';\n\n      var addParam = function addParam(key, value) {\n        if (queryString) {\n          queryString += \"&\" + key + \"=\" + value;\n        } else {\n          queryString += key + \"=\" + value;\n        }\n      };\n\n      if (_this.appbaseSettings && _this.appbaseSettings.userId) {\n        addParam('user_id', _this.appbaseSettings.userId);\n      }\n\n      if (queryOptions) {\n        if (queryOptions.size) {\n          addParam('size', String(queryOptions.size));\n        }\n\n        if (queryOptions.from) {\n          addParam('from', queryOptions.from);\n        }\n\n        if (queryOptions.to) {\n          addParam('to', queryOptions.to);\n        }\n\n        if (queryOptions.minChars) {\n          addParam('min_chars', String(queryOptions.minChars));\n        }\n\n        if (queryOptions.customEvents) {\n          Object.keys(queryOptions.customEvents).forEach(function (key) {\n            // $FlowFixMe\n            addParam(key, queryOptions.customEvents[key]);\n          });\n        }\n      }\n\n      return new Promise(function (resolve, reject) {\n        fetch(_this.url + \"/_analytics/\" + _this._getSearchIndex() + \"/recent-searches?\" + queryString, requestOptions).then(function (res) {\n          if (res.status >= 500) {\n            return reject(res);\n          }\n\n          if (res.status >= 400) {\n            return reject(res);\n          }\n\n          return res.json().then(function (recentSearches) {\n            var prev = _this.recentSearches;\n            _this.recentSearches = recentSearches.map(function (searchObject) {\n              return {\n                label: searchObject.key,\n                value: searchObject.key\n              };\n            });\n\n            _this._applyOptions({\n              stateChanges: options.stateChanges\n            }, 'recentSearches', prev, _this.recentSearches);\n\n            resolve(_this.recentSearches); // Populate the recent searches\n          })[\"catch\"](function (e) {\n            console.warn('SearchBase: error while fetching the recent searches ', e);\n            return reject(e);\n          });\n        })[\"catch\"](function (e) {\n          console.warn('SearchBase: error while fetching the recent searches ', e);\n          return reject(e);\n        });\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_handleVoiceResults\", function (_ref3, options) {\n      var results = _ref3.results;\n\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      if (results && results[0] && results[0].isFinal && results[0][0] && results[0][0].transcript && results[0][0].transcript.trim()) {\n        _this.setValue(results[0][0].transcript.trim(), _extends({}, options, {\n          triggerCustomQuery: true,\n          triggerDefaultQuery: true\n        }));\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_stopMic\", function () {\n      if (_this._micInstance) {\n        _this._micInstance.stop();\n\n        _this._micInstance = null;\n\n        _this._setMicStatus(MIC_STATUS.inactive);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"_setMicStatus\", function (status, options) {\n      if (options === void 0) {\n        options = defaultOptions;\n      }\n\n      var prevStatus = _this._micStatus;\n      _this._micStatus = status;\n\n      _this._applyOptions(options, 'micStatus', prevStatus, _this._micStatus);\n    });\n\n    var _id = rsAPIConfig.id,\n        type = rsAPIConfig.type,\n        _react = rsAPIConfig.react,\n        queryFormat = rsAPIConfig.queryFormat,\n        _dataField = rsAPIConfig.dataField,\n        categoryField = rsAPIConfig.categoryField,\n        categoryValue = rsAPIConfig.categoryValue,\n        nestedField = rsAPIConfig.nestedField,\n        _from = rsAPIConfig.from,\n        _size = rsAPIConfig.size,\n        _sortBy = rsAPIConfig.sortBy,\n        _value = rsAPIConfig.value,\n        aggregationField = rsAPIConfig.aggregationField,\n        aggregationSize = rsAPIConfig.aggregationSize,\n        _after = rsAPIConfig.after,\n        includeNullValues = rsAPIConfig.includeNullValues,\n        _includeFields = rsAPIConfig.includeFields,\n        _excludeFields = rsAPIConfig.excludeFields,\n        _fuzziness = rsAPIConfig.fuzziness,\n        searchOperators = rsAPIConfig.searchOperators,\n        highlight = rsAPIConfig.highlight,\n        highlightField = rsAPIConfig.highlightField,\n        customHighlight = rsAPIConfig.customHighlight,\n        interval = rsAPIConfig.interval,\n        aggregations = rsAPIConfig.aggregations,\n        missingLabel = rsAPIConfig.missingLabel,\n        showMissing = rsAPIConfig.showMissing,\n        _defaultQuery = rsAPIConfig.defaultQuery,\n        _customQuery = rsAPIConfig.customQuery,\n        execute = rsAPIConfig.execute,\n        enableSynonyms = rsAPIConfig.enableSynonyms,\n        selectAllLabel = rsAPIConfig.selectAllLabel,\n        pagination = rsAPIConfig.pagination,\n        _queryString = rsAPIConfig.queryString,\n        distinctField = rsAPIConfig.distinctField,\n        distinctFieldConfig = rsAPIConfig.distinctFieldConfig;\n\n    if (!_id) {\n      throw new Error(errorMessages.invalidComponentId);\n    } // dataField is required for components other then search\n\n\n    if (type && type !== queryTypes.Search) {\n      if (!_dataField) {\n        throw new Error(errorMessages.invalidDataField);\n      } else if (Array.isArray(_dataField)) {\n        throw new Error(errorMessages.dataFieldAsArray);\n      }\n    }\n\n    _this.id = _id;\n    _this.type = type;\n    _this.react = _react;\n    _this.queryFormat = queryFormat;\n    _this.dataField = _dataField;\n    _this.categoryField = categoryField;\n    _this.categoryValue = categoryValue;\n    _this.nestedField = nestedField;\n    _this.from = _from;\n    _this.size = _size;\n    _this.sortBy = _sortBy;\n    _this.aggregationField = aggregationField;\n    _this.aggregationSize = aggregationSize;\n    _this.after = _after;\n    _this.includeNullValues = includeNullValues;\n    _this.includeFields = _includeFields;\n    _this.excludeFields = _excludeFields;\n    _this.fuzziness = _fuzziness;\n    _this.searchOperators = searchOperators;\n    _this.highlight = highlight;\n    _this.highlightField = highlightField;\n    _this.customHighlight = customHighlight;\n    _this.interval = interval;\n    _this.aggregations = aggregations;\n    _this.missingLabel = missingLabel;\n    _this.showMissing = showMissing;\n    _this.execute = execute;\n    _this.enableSynonyms = enableSynonyms;\n    _this.selectAllLabel = selectAllLabel;\n    _this.pagination = pagination;\n    _this.queryString = _queryString;\n    _this.defaultQuery = _defaultQuery;\n    _this.customQuery = _customQuery;\n    _this.beforeValueChange = beforeValueChange;\n    _this.onValueChange = onValueChange;\n    _this.onResults = onResults;\n    _this.onAggregationData = onAggregationData;\n    _this.onError = onError;\n    _this.onRequestStatusChange = onRequestStatusChange;\n    _this.onQueryChange = onQueryChange;\n    _this.onMicStatusChange = onMicStatusChange;\n    _this.distinctField = distinctField;\n    _this.distinctFieldConfig = distinctFieldConfig; // other properties\n\n    _this.enablePopularSuggestions = enablePopularSuggestions;\n    _this.maxPopularSuggestions = maxPopularSuggestions;\n    _this.showDistinctSuggestions = showDistinctSuggestions;\n    _this.enablePredictiveSuggestions = enablePredictiveSuggestions;\n    _this.preserveResults = preserveResults;\n    _this.clearOnQueryChange = clearOnQueryChange; // Initialize the state changes observable\n\n    _this.stateChanges = new Observable();\n    _this.results = new Results(_results);\n    _this.aggregationData = new Aggregations();\n\n    if (_value) {\n      _this.setValue(_value, {\n        stateChanges: true\n      });\n    } else {\n      _this.value = _value;\n    }\n\n    return _this;\n  } // getters\n\n\n  var _proto = SearchComponent.prototype;\n\n  _proto.getSuggestionsQuery = function getSuggestionsQuery() {\n    return {\n      query: [{\n        id: suggestionQueryID,\n        dataField: popularSuggestionFields,\n        size: this.maxPopularSuggestions || 5,\n        value: this.value,\n        defaultQuery: {\n          query: {\n            bool: {\n              minimum_should_match: 1,\n              should: [{\n                function_score: {\n                  field_value_factor: {\n                    field: 'count',\n                    modifier: 'sqrt',\n                    missing: 1\n                  }\n                }\n              }, {\n                multi_match: {\n                  fields: ['key^9', 'key.autosuggest^1', 'key.keyword^10'],\n                  fuzziness: 0,\n                  operator: 'or',\n                  query: this.value,\n                  type: 'best_fields'\n                }\n              }, {\n                multi_match: {\n                  fields: ['key^9', 'key.autosuggest^1', 'key.keyword^10'],\n                  operator: 'or',\n                  query: this.value,\n                  type: 'phrase'\n                }\n              }, {\n                multi_match: {\n                  fields: ['key^9'],\n                  operator: 'or',\n                  query: this.value,\n                  type: 'phrase_prefix'\n                }\n              }]\n            }\n          }\n        }\n      }]\n    };\n  } // use this methods to record a search click event\n  ;\n\n  /* -------- Private methods only for the internal use -------- */\n  _proto._appendResults = function _appendResults(rawResults) {\n    if (this.preserveResults && rawResults && Array.isArray(rawResults.hits && rawResults.hits.hits) && Array.isArray(this.results.rawData && this.results.rawData.hits && this.results.rawData.hits.hits)) {\n      this.results.setRaw(_extends({}, rawResults, {\n        hits: _extends({}, rawResults.hits, {\n          hits: [].concat(this.results.rawData.hits.hits, rawResults.hits.hits)\n        })\n      }));\n    } else {\n      this.results.setRaw(rawResults);\n    }\n  } // Method to apply the changed based on set options\n  ;\n\n  _proto._applyOptions = function _applyOptions(options, key, prevValue, nextValue) {\n    // // Trigger mic events\n    if (key === 'micStatus' && this.onMicStatusChange) {\n      this.onMicStatusChange(nextValue, prevValue);\n    } // Trigger events\n\n\n    if (key === 'query' && this.onQueryChange) {\n      this.onQueryChange(nextValue, prevValue);\n    }\n\n    if (key === 'value' && this.onValueChange) {\n      this.onValueChange(nextValue, prevValue);\n    }\n\n    if (key === 'error' && this.onError) {\n      this.onError(nextValue);\n    }\n\n    if (key === 'results' && this.onResults) {\n      this.onResults(nextValue, prevValue);\n    }\n\n    if (key === 'aggregationData' && this.onAggregationData) {\n      this.onAggregationData(nextValue, prevValue);\n    }\n\n    if (key === 'requestStatus' && this.onRequestStatusChange) {\n      this.onRequestStatusChange(nextValue, prevValue);\n    }\n\n    if (options.triggerDefaultQuery) {\n      this.triggerDefaultQuery();\n    }\n\n    if (options.triggerCustomQuery) {\n      this.triggerCustomQuery();\n    }\n\n    if (options.stateChanges !== false) {\n      var _this$stateChanges$ne;\n\n      this.stateChanges.next((_this$stateChanges$ne = {}, _this$stateChanges$ne[key] = {\n        prev: prevValue,\n        next: nextValue\n      }, _this$stateChanges$ne), key, this);\n    }\n  };\n\n  _proto._getSearchIndex = function _getSearchIndex(isPopularSuggestionsAPI) {\n    if (isPopularSuggestionsAPI === void 0) {\n      isPopularSuggestionsAPI = false;\n    }\n\n    var index = this.index;\n\n    if (isPopularSuggestionsAPI) {\n      index = '.suggestions';\n    } else if (this._parent && this._parent.index) {\n      index = this._parent.index;\n    }\n\n    return index;\n  };\n\n  _proto._fetchRequest = function _fetchRequest(requestBody, isPopularSuggestionsAPI) {\n    var _this2 = this;\n\n    if (isPopularSuggestionsAPI === void 0) {\n      isPopularSuggestionsAPI = false;\n    }\n\n    // remove undefined properties from request body\n    var requestOptions = {\n      method: 'POST',\n      body: JSON.stringify(requestBody),\n      headers: _extends({}, this.headers)\n    };\n    return new Promise(function (resolve, reject) {\n      _this2._handleTransformRequest(requestOptions).then(function (finalRequestOptions) {\n        // set timestamp in request\n        var timestamp = Date.now();\n        var suffix = '_reactivesearch.v3';\n\n        var index = _this2._getSearchIndex(isPopularSuggestionsAPI);\n\n        return fetch(_this2.url + \"/\" + index + \"/\" + suffix, finalRequestOptions).then(function (res) {\n          var responseHeaders = res.headers; // check if search component is present\n\n          if (res.headers) {\n            var queryID = res.headers.get('X-Search-Id');\n\n            if (queryID) {\n              // if parent exists then set the queryID to parent\n              if (_this2._parent) {\n                _this2._parent.setQueryID(queryID);\n              } else {\n                _this2.setQueryID(queryID);\n              }\n            }\n          }\n\n          if (res.status >= 500) {\n            return reject(res);\n          }\n\n          if (res.status >= 400) {\n            return reject(res);\n          }\n\n          return res.json().then(function (data) {\n            _this2._handleTransformResponse(data).then(function (transformedData) {\n              if (transformedData && Object.prototype.hasOwnProperty.call(transformedData, 'error')) {\n                reject(transformedData);\n              }\n\n              var response = _extends({}, transformedData, {\n                _timestamp: timestamp,\n                _headers: responseHeaders\n              });\n\n              return resolve(response);\n            })[\"catch\"](function (e) {\n              console.warn('SearchBase: transformResponse rejected the promise with ', e);\n              return reject(e);\n            });\n          });\n        })[\"catch\"](function (e) {\n          return reject(e);\n        });\n      })[\"catch\"](function (e) {\n        console.warn('SearchBase: transformRequest rejected the promise with ', e);\n        return reject(e);\n      });\n    });\n  } // Method to generate the final query based on the component's value changes\n  ;\n\n  _proto._generateQuery = function _generateQuery() {\n    var _this3 = this;\n\n    /**\n     * This method performs the following tasks to generate the query\n     * 1. Get all the watcher components for a particular component ID\n     * 2. Make the request payload\n     * 3. Execute the final query\n     * 4. Update results and trigger events => Call `setResults` or `setAggregations` based on the results\n     */\n    if (this._parent) {\n      var components = this._parent.getComponents();\n\n      var watcherComponents = []; // Find all the  watcher components\n\n      Object.keys(components).forEach(function (id) {\n        var componentInstance = components[id];\n\n        if (componentInstance && componentInstance.react) {\n          var flattenReact = flatReactProp(componentInstance.react, id);\n\n          if (flattenReact.indexOf(_this3.id) > -1) {\n            watcherComponents.push(id);\n          }\n        }\n      });\n      var requestQuery = {}; // Generate the request body for watchers\n\n      watcherComponents.forEach(function (watcherId) {\n        var component = _this3._parent.getComponent(watcherId);\n\n        if (component) {\n          requestQuery[watcherId] = component.componentQuery; // collect queries for all components defined in the `react` property\n          // that have some value defined\n\n          var flattenReact = flatReactProp(component.react, component.id);\n          flattenReact.forEach(function (id) {\n            // only add if not present\n            if (!requestQuery[id]) {\n              var dependentComponent = _this3._parent.getComponent(id);\n\n              if (dependentComponent && dependentComponent.value) {\n                // Set the execute to `false` for dependent components\n                var query = dependentComponent.componentQuery;\n                query.execute = false; // Add the query to request payload\n\n                requestQuery[id] = query;\n              }\n            }\n          });\n        }\n      });\n      return {\n        requestBody: Object.values(requestQuery),\n        orderOfQueries: watcherComponents\n      };\n    }\n\n    return {\n      requestBody: [],\n      orderOfQueries: []\n    };\n  };\n\n  _proto._handleTransformResponse = function _handleTransformResponse(res) {\n    if (this.transformResponse && typeof this.transformResponse === 'function') {\n      return this.transformResponse(res);\n    }\n\n    return new Promise(function (resolve) {\n      return resolve(res);\n    });\n  };\n\n  _proto._handleTransformRequest = function _handleTransformRequest(requestOptions) {\n    if (this.transformRequest && typeof this.transformRequest === 'function') {\n      return this.transformRequest(requestOptions);\n    }\n\n    return new Promise(function (resolve) {\n      return resolve(requestOptions);\n    });\n  };\n\n  _proto._handleAggregationResponse = function _handleAggregationResponse(aggsResponse, options, append) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    if (append === void 0) {\n      append = true;\n    }\n\n    var aggregationField = this.aggregationField;\n\n    if (!aggregationField && typeof this.dataField === 'string') {\n      aggregationField = this.dataField;\n    }\n\n    var prev = this.aggregationData;\n    this.aggregationData.setRaw(aggsResponse[aggregationField]);\n    this.aggregationData.setData(aggregationField, aggsResponse[aggregationField].buckets, this.preserveResults && append);\n\n    this._applyOptions({\n      stateChanges: options.stateChanges\n    }, 'aggregationData', prev, this.aggregationData);\n  };\n\n  _proto._setError = function _setError(error, options) {\n    if (options === void 0) {\n      options = defaultOptions;\n    }\n\n    this._setRequestStatus(REQUEST_STATUS.error);\n\n    var prev = this.error;\n    this.error = error;\n\n    this._applyOptions(options, 'error', prev, this.error);\n  };\n\n  _proto._setRequestStatus = function _setRequestStatus(requestStatus) {\n    var prev = this.requestStatus;\n    this.requestStatus = requestStatus;\n\n    this._applyOptions({\n      stateChanges: true\n    }, 'requestStatus', prev, this.requestStatus);\n  } // Method to set the default query value\n  ;\n\n  _proto._updateQuery = function _updateQuery(query) {\n    var _this4 = this;\n\n    var prevQuery;\n    prevQuery = _extends({}, this._query);\n    var finalQuery = [this.componentQuery];\n    var flattenReact = flatReactProp(this.react, this.id);\n    flattenReact.forEach(function (id) {\n      // only add if not present\n      var watcherComponent = _this4._parent.getComponent(id);\n\n      if (watcherComponent && watcherComponent.value) {\n        // Set the execute to `false` for watcher components\n        var watcherQuery = watcherComponent.componentQuery;\n        watcherQuery.execute = false; // Add the query to request payload\n\n        finalQuery.push(watcherQuery);\n      }\n    });\n    this._query = query || finalQuery;\n\n    this._applyOptions({\n      stateChanges: false\n    }, 'query', prevQuery, this._query);\n  } // mic\n  ;\n\n  _createClass(SearchComponent, [{\n    key: \"micStatus\",\n    get: function get() {\n      return this._micStatus;\n    }\n  }, {\n    key: \"micInstance\",\n    get: function get() {\n      return this._micInstance;\n    }\n  }, {\n    key: \"micActive\",\n    get: function get() {\n      return this._micStatus === MIC_STATUS.active;\n    }\n  }, {\n    key: \"micInactive\",\n    get: function get() {\n      return this._micStatus === MIC_STATUS.inactive;\n    }\n  }, {\n    key: \"micDenied\",\n    get: function get() {\n      return this._micStatus === MIC_STATUS.denied;\n    }\n  }, {\n    key: \"query\",\n    get: function get() {\n      return this._query;\n    }\n  }, {\n    key: \"requestPending\",\n    get: function get() {\n      return this.requestStatus === REQUEST_STATUS.pending;\n    }\n  }, {\n    key: \"appbaseSettings\",\n    get: function get() {\n      var _ref4 = this.appbaseConfig || {},\n          recordAnalytics = _ref4.recordAnalytics,\n          customEvents = _ref4.customEvents,\n          enableQueryRules = _ref4.enableQueryRules,\n          userId = _ref4.userId;\n\n      return {\n        recordAnalytics: recordAnalytics,\n        customEvents: customEvents,\n        enableQueryRules: enableQueryRules,\n        userId: userId\n      };\n    } // To get the parsed suggestions from the results\n\n  }, {\n    key: \"suggestions\",\n    get: function get() {\n      if (this.type && this.type !== queryTypes.Search) {\n        return [];\n      }\n\n      if (this.results) {\n        var fields = getNormalizedField(this.dataField) || [];\n\n        if (fields.length === 0 && this.results.data && Array.isArray(this.results.data) && this.results.data.length > 0 && this.results.data[0]) {\n          // Extract fields from _source\n          fields = Object.keys(this.results.data[0]).filter(function (key) {\n            return !['_id', '_click_id', '_index', '_score', '_type'].includes(key);\n          });\n        }\n\n        if (this.enablePopularSuggestions) {\n          // extract suggestions from popular suggestion fields too\n          fields = [].concat(fields, popularSuggestionFields);\n        }\n\n        return getSuggestions(fields, this.results.data, this.value, this.showDistinctSuggestions, this.enablePredictiveSuggestions).slice(0, this.size);\n      }\n\n      return [];\n    } // Method to get the raw query based on the current state\n\n  }, {\n    key: \"componentQuery\",\n    get: function get() {\n      return {\n        id: this.id,\n        type: this.type,\n        dataField: getNormalizedField(this.dataField),\n        react: this.react,\n        highlight: this.highlight,\n        highlightField: getNormalizedField(this.highlightField),\n        fuzziness: this.fuzziness,\n        searchOperators: this.searchOperators,\n        includeFields: this.includeFields,\n        excludeFields: this.excludeFields,\n        size: this.size,\n        from: this.from,\n        queryFormat: this.queryFormat,\n        sortBy: this.sortBy,\n        fieldWeights: getNormalizedWeights(this.dataField),\n        includeNullValues: this.includeNullValues,\n        aggregationField: this.aggregationField,\n        aggregationSize: this.aggregationSize,\n        categoryField: this.categoryField,\n        missingLabel: this.missingLabel,\n        showMissing: this.showMissing,\n        nestedField: this.nestedField,\n        interval: this.interval,\n        customHighlight: this.customHighlight,\n        customQuery: this.customQuery ? this.customQuery(this) : undefined,\n        defaultQuery: this.defaultQuery ? this.defaultQuery(this) : undefined,\n        value: this.value,\n        categoryValue: this.categoryValue,\n        after: this.after,\n        aggregations: this.aggregations,\n        enableSynonyms: this.enableSynonyms,\n        selectAllLabel: this.selectAllLabel,\n        pagination: this.pagination,\n        queryString: this.queryString,\n        distinctField: this.distinctField,\n        distinctFieldConfig: this.distinctFieldConfig,\n        index: this.index\n      };\n    }\n  }, {\n    key: \"queryId\",\n    get: function get() {\n      // Get query ID from parent(searchbase) if exist\n      if (this._parent && this._parent._queryId) {\n        return this._parent._queryId;\n      } // For single components just return the queryId from the component\n\n\n      if (this._queryId) {\n        return this._queryId;\n      }\n\n      return '';\n    }\n  }, {\n    key: \"mappedProps\",\n    get: function get() {\n      var _this5 = this;\n\n      var mappedProps = {};\n      Object.keys(searchBaseMappings).forEach(function (key) {\n        // $FlowFixMe\n        mappedProps[searchBaseMappings[key]] = _this5[key];\n      });\n      return mappedProps;\n    }\n    /* -------- Public methods -------- */\n    // mic click handler\n\n  }]);\n\n  return SearchComponent;\n}(Base);\n\n/**\n * SearchBase class will act like the ReactiveBase component.\n * It works as a centralized store that will have the info about active/registered components.\n */\nvar SearchBase = /*#__PURE__*/function (_Base) {\n  _inheritsLoose(SearchBase, _Base);\n\n  /* ------ Private properties only for the internal use ----------- */\n  // active components\n  function SearchBase(_ref) {\n    var _this;\n\n    var index = _ref.index,\n        url = _ref.url,\n        credentials = _ref.credentials,\n        headers = _ref.headers,\n        appbaseConfig = _ref.appbaseConfig;\n    _this = _Base.call(this, {\n      index: index,\n      url: url,\n      credentials: credentials,\n      headers: headers,\n      appbaseConfig: appbaseConfig\n    }) || this;\n\n    _defineProperty(_assertThisInitialized(_this), \"register\", function (componentId, component) {\n      if (!componentId) {\n        throw new Error(errorMessages.invalidComponentId);\n      }\n\n      if (_this._components[componentId]) {\n        // return existing instance\n        return _this._components[componentId];\n      }\n\n      var componentInstance = component;\n\n      if (component && !(component instanceof SearchComponent)) {\n        // create instance from object with all the options\n        componentInstance = new SearchComponent(_extends({}, component, {\n          id: componentId,\n          index: component.index || _this.index,\n          url: component.url || _this.url,\n          credentials: component.credentials || _this.credentials,\n          headers: component.headers || _this.headers,\n          transformRequest: component.transformRequest || _this.transformRequest,\n          transformResponse: component.transformResponse || _this.transformResponse,\n          appbaseConfig: component.appbaseConfig || _this.appbaseConfig\n        }));\n      } else {\n        // set the id property on instance\n        componentInstance.id = componentId;\n      } // register component\n\n\n      _this._components[componentId] = componentInstance; // set the search base instance as parent\n\n      componentInstance.setParent(_assertThisInitialized(_this));\n      return componentInstance;\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"unregister\", function (componentId) {\n      if (componentId) {\n        delete _this._components[componentId];\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getComponent\", function (componentId) {\n      return _this._components[componentId];\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"getComponents\", function () {\n      return _this._components;\n    });\n\n    _this._components = {};\n    return _this;\n  } // To register a component\n\n\n  return SearchBase;\n}(Base);\n\nexport { SearchBase, SearchComponent };\n"]},"metadata":{},"sourceType":"module"}